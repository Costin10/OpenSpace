const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SimpleTerminalPane-Brvwg3Wo.js","assets/vendor-codemirror-YmvNK9KJ.js","assets/vendor-markdown-Bqz58gXN.js","assets/vendor-xterm-B6483nPg.js","assets/rows-2-lhzUQW9r.js","assets/index-BjdFrzXK.js","assets/vendor-react-bmmOCWbf.js","assets/index-BW7OmidL.css","assets/circle-x-BsZCwU-6.js","assets/SimpleTerminalPane-DOrYoP_4.css","assets/EditorPane-ClvhC1ZG.js","assets/folder-open-Bjr2Gydc.js","assets/trash-2-B4sySCZE.js","assets/terminal-CxvecJyb.js","assets/refresh-cw-Du5FK0wQ.js","assets/eye-DsInCY-v.js","assets/chevron-left-BRK2ZYh3.js","assets/circle-CaS7GgL4.js","assets/WelcomeScreen-BqxlFsnG.js","assets/keyboard-Bs410ZuA.js","assets/KanbanBoard-BHpy45A2.js","assets/useApi-BCHzo7MO.js","assets/CreateProjectModal-DZE9Qx9e.js","assets/AgentsPage-CWJgCA9f.js","assets/circle-alert-DGt2vr4w.js","assets/PromptsPage-DeL-hXx5.js","assets/user-lpBBC617.js","assets/SettingsPage-C7gyz6SV.js"])))=>i.map(i=>d[i]);
import{_ as Pe}from"./vendor-markdown-Bqz58gXN.js";import{r as c,j as a,R as pe}from"./vendor-codemirror-YmvNK9KJ.js";import{c as q,X as Ne,a as M,b as Jt,u as Qt,L as Xn,d as qn}from"./index-BjdFrzXK.js";import{r as Zt}from"./vendor-react-bmmOCWbf.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Jn=q("bot",Yn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],en=q("chevron-down",Qn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],tn=q("chevron-right",Zn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],tr=q("code-xml",er);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],rr=q("copy",nr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],sr=q("cpu",ar);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],kt=q("download",or);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],nn=q("file-text",ir);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],rn=q("folder",lr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=[["path",{d:"M5 3v14",key:"9nsxs2"}],["path",{d:"M12 3v8",key:"1h2ygw"}],["path",{d:"M19 3v18",key:"1sk56x"}]],dr=q("kanban",cr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],fr=q("layout-grid",ur);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],mr=q("loader-circle",pr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=[["path",{d:"M5 12h14",key:"1ays0h"}]],an=q("minus",hr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],gr=q("palette",xr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],yr=q("pencil",br);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ct=q("plus",vr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],kr=q("scroll-text",wr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],jr=q("search",Cr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],sn=q("settings",Sr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Nr=q("sliders-horizontal",Pr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]],Er=q("square-terminal",zr);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Lr=q("square",Ir),on=[{id:"single",name:"Single Terminal",description:"One terminal (default)",terminalCount:1,grid:{rows:1,cols:1},icon:"Terminal"},{id:"template-2",name:"2 Terminals",description:"Side-by-side horizontal split",terminalCount:2,grid:{rows:1,cols:2},icon:"Columns2"},{id:"template-4",name:"4 Terminals",description:"2×2 grid layout",terminalCount:4,grid:{rows:2,cols:2},icon:"Grid2x2"},{id:"template-6",name:"6 Terminals",description:"2 rows × 3 columns",terminalCount:6,grid:{rows:2,cols:3},icon:"LayoutGrid"},{id:"template-8",name:"8 Terminals",description:"2 rows × 4 columns",terminalCount:8,grid:{rows:2,cols:4},icon:"LayoutGrid"},{id:"template-10",name:"10 Terminals",description:"2 rows × 5 columns",terminalCount:10,grid:{rows:2,cols:5},icon:"LayoutGrid"},{id:"template-12",name:"12 Terminals",description:"3 rows × 4 columns",terminalCount:12,grid:{rows:3,cols:4},icon:"LayoutGrid"},{id:"template-14",name:"14 Terminals",description:"2 rows × 7 columns",terminalCount:14,grid:{rows:2,cols:7},icon:"LayoutGrid"},{id:"template-16",name:"16 Terminals",description:"4×4 grid layout",terminalCount:16,grid:{rows:4,cols:4},icon:"LayoutGrid"}];function ln(){return`pane-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function Ke(e){return{type:"terminal",id:ln(),session:e}}function Be(e,t){return{type:"split",id:ln(),direction:e,children:t,sizes:null}}function ot(e){return on.find(t=>t.id===e)}function Tr(e,t){const n=ot(e);return!n||t.length===0?null:n.terminalCount===1||t.length===1?Ke(t[0]):Dr(t,n.grid.rows,n.grid.cols)}function Dr(e,t,n){if(t===1){const s=e.slice(0,n).map(o=>Ke(o));return Be("horizontal",s)}if(n===1){const s=e.slice(0,t).map(o=>Ke(o));return Be("vertical",s)}const r=[];for(let s=0;s<t;s++){const o=s*n,l=e.slice(o,o+n);if(l.length===0)break;const i=l.map(u=>Ke(u));i.length===1?r.push(i[0]):r.push(Be("horizontal",i))}return r.length===1?r[0]:Be("vertical",r)}const Ct=[{id:"claude",name:"Claude",command:"claude",count:0,enabled:!1},{id:"codex",name:"Codex",command:"codex",count:0,enabled:!1},{id:"gemini",name:"Gemini",command:"gemini",count:0,enabled:!1},{id:"cursor",name:"Cursor",command:"agent",count:0,enabled:!1},{id:"opencode",name:"OpenCode",command:"opencode",count:0,enabled:!1}];function Mr({rows:e,cols:t,isSelected:n}){return a.jsx("div",{className:"grid gap-[3px] w-10 h-7",style:{gridTemplateColumns:`repeat(${t}, 1fr)`,gridTemplateRows:`repeat(${e}, 1fr)`},children:Array.from({length:e*t}).map((r,s)=>a.jsx("div",{className:M("rounded-[2px] transition-colors",n?"bg-accent-blue":"bg-text-muted/40")},s))})}function Ar({value:e,onChange:t,min:n=0,max:r=10,disabled:s=!1}){return a.jsxs("div",{className:M("flex items-center gap-1",s&&"opacity-40"),children:[a.jsx("button",{onClick:()=>t(Math.max(n,e-1)),disabled:s||e<=n,className:M("w-6 h-6 rounded flex items-center justify-center","bg-background border border-border","hover:bg-surface-hover hover:border-text-muted","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors"),children:a.jsx(an,{size:12})}),a.jsx("span",{className:"w-6 text-center text-sm font-medium text-text-primary",children:e}),a.jsx("button",{onClick:()=>t(Math.min(r,e+1)),disabled:s||e>=r,className:M("w-6 h-6 rounded flex items-center justify-center","bg-background border border-border","hover:bg-surface-hover hover:border-text-muted","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors"),children:a.jsx(ct,{size:12})})]})}function Rr({isOpen:e,onClose:t,onSelect:n,defaultDirectory:r}){const s=on,[o,l]=c.useState(0),[i,u]=c.useState("~"),[p,d]=c.useState("~"),[b,v]=c.useState(!1),[j,k]=c.useState(!1),[f,m]=c.useState(Ct.map(P=>({...P})));c.useEffect(()=>{e&&!b&&(l(0),v(!0),k(!1),m(Ct.map(_=>({..._}))),(async()=>{try{const _=await window.tauriAPI?.system?.getHomeDir(),B=r||_||"~";u(B);const A=await g(B);d(A)}catch{u("~"),d("~")}})()),e||v(!1)},[e,b,r]);const g=async P=>{try{const _=await window.tauriAPI?.system?.getHomeDir();if(_&&P.startsWith(_))return"~"+P.slice(_.length);const B=P.split("/").filter(Boolean);return B.length>3?".../"+B.slice(-2).join("/"):P}catch{return P}},y=async()=>{try{const P=await window.tauriAPI?.dialog?.openFolder({defaultPath:i,title:"Select Workspace Directory"});if(P){u(P);const _=await g(P);d(_)}}catch{}},S=(P,_)=>{m(B=>B.map(A=>{if(A.id===P){const X={...A,..._};return _.enabled&&A.count===0&&(X.count=1),_.count===0&&(X.enabled=!1),_.count&&_.count>0&&(X.enabled=!0),X}return A}))},C=f.reduce((P,_)=>P+(_.enabled?_.count:0),0),z=f.filter(P=>P.enabled).length,T=z===f.length,E=z===0,W=s[o].terminalCount,G=()=>{m(P=>P.map(_=>({..._,enabled:!0,count:Math.max(_.count,1)})))},U=()=>{m(P=>P.map(_=>({..._,enabled:!1,count:0})))},O=()=>{m(P=>P.map(_=>({..._,enabled:!0,count:1})))},F=()=>{const P=f.length,_=Math.floor(W/P);let B=W%P;m(A=>A.map(X=>{const Y=_+(B-- >0?1:0);return{...X,enabled:Y>0,count:Y}}))};c.useEffect(()=>{m(P=>{const _=P.reduce((X,Y)=>X+(Y.enabled?Y.count:0),0);if(_<=W)return P;const B=W/_;let A=W;return P.map((X,Y)=>{if(!X.enabled)return X;const de=Y===P.length-1||P.slice(Y+1).every(ye=>!ye.enabled)?A:Math.max(1,Math.round(X.count*B));if(A-=de,A<0){const ye=Math.max(0,de+A);return A=0,{...X,count:ye,enabled:ye>0}}return{...X,count:de}})})},[W]);const K=c.useCallback(P=>{switch(P.key){case"ArrowRight":P.preventDefault(),l(B=>Math.min(B+1,s.length-1));break;case"ArrowLeft":P.preventDefault(),l(B=>Math.max(B-1,0));break;case"ArrowDown":P.preventDefault(),l(B=>Math.min(B+3,s.length-1));break;case"ArrowUp":P.preventDefault(),l(B=>Math.max(B-3,0));break;case"Enter":P.preventDefault(),n(s[o].id,i,f);break;case"Escape":P.preventDefault(),t();break}},[s,o,i,f,t,n]);return e?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-12",onClick:P=>{P.target===P.currentTarget&&t()},children:[a.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),a.jsxs("div",{className:M("relative bg-surface border border-border rounded-xl shadow-2xl","w-[340px] max-h-[85vh] overflow-y-auto animate-slide-up"),onKeyDown:K,tabIndex:0,children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border sticky top-0 bg-surface z-10",children:[a.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"New Workspace"}),a.jsx("button",{onClick:t,className:"p-1 rounded hover:bg-surface-hover text-text-muted hover:text-text-primary transition-colors",children:a.jsx(Ne,{size:14})})]}),a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-text-muted mb-2 uppercase tracking-wide",children:"Layout"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.map((P,_)=>{const B=o===_;return a.jsxs("button",{onClick:()=>l(_),className:M("flex flex-col items-center gap-2 p-3 rounded-lg transition-all duration-100","border-2 cursor-pointer",B?"bg-surface-hover border-accent-blue":"bg-background border-border hover:bg-surface-hover hover:border-text-muted"),children:[a.jsx(Mr,{rows:P.grid.rows,cols:P.grid.cols,isSelected:B}),a.jsx("span",{className:M("text-xs font-medium",B?"text-accent-blue":"text-text-muted"),children:P.terminalCount===1?"Single":P.terminalCount})]},P.id)})}),a.jsx("div",{className:"text-xs text-text-muted text-center mt-2",children:s[o].description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-text-muted mb-1.5 uppercase tracking-wide",children:"Directory"}),a.jsxs("button",{onClick:y,className:M("w-full flex items-center gap-2 px-3 py-2 rounded-lg text-left","bg-background border border-border","hover:border-accent-blue/50 hover:bg-surface-hover","transition-colors group"),children:[a.jsx(rn,{size:14,className:"text-text-muted group-hover:text-accent-blue flex-shrink-0"}),a.jsx("span",{className:"text-sm text-text-secondary truncate flex-1",children:p}),a.jsx("span",{className:"text-xs text-text-muted group-hover:text-text-secondary",children:"Browse"})]})]}),a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>k(!j),className:M("w-full flex items-center justify-between px-0 py-1","text-xs font-medium text-text-muted uppercase tracking-wide","hover:text-text-secondary transition-colors"),children:[a.jsxs("span",{className:"flex items-center gap-1",children:[j?a.jsx(en,{size:12}):a.jsx(tn,{size:12}),"AI Agents",C>0&&a.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-[10px] bg-accent-blue/20 text-accent-blue rounded",children:C})]}),a.jsx("span",{className:"text-[10px] normal-case tracking-normal font-normal",children:j?"collapse":"optional"})]}),j&&a.jsxs("div",{className:"mt-2 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[a.jsx("button",{onClick:T?U:G,className:M("px-2 py-1 rounded text-[10px] font-medium transition-colors","border border-border hover:border-text-muted",T?"bg-accent-blue/10 text-accent-blue border-accent-blue/30":"bg-background text-text-muted hover:text-text-secondary"),children:T?"Deselect All":"Select All"}),a.jsx("button",{onClick:O,className:M("px-2 py-1 rounded text-[10px] font-medium transition-colors","bg-background border border-border text-text-muted","hover:border-text-muted hover:text-text-secondary"),children:"1 Each"}),a.jsx("button",{onClick:F,className:M("px-2 py-1 rounded text-[10px] font-medium transition-colors","bg-background border border-border text-text-muted","hover:border-text-muted hover:text-text-secondary"),children:"Fill Evenly"}),!E&&a.jsx("button",{onClick:U,className:M("px-2 py-1 rounded text-[10px] font-medium transition-colors","bg-background border border-border text-text-muted","hover:border-red-500/50 hover:text-red-400"),children:"Clear"})]}),f.map(P=>a.jsxs("div",{className:M("flex items-center justify-between px-3 py-2 rounded-lg","bg-background border border-border",P.enabled&&"border-accent-blue/30 bg-accent-blue/5"),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>S(P.id,{enabled:!P.enabled,count:P.enabled?0:1}),className:M("w-4 h-4 rounded border-2 flex items-center justify-center transition-colors",P.enabled?"bg-accent-blue border-accent-blue":"border-text-muted/50 hover:border-text-muted"),children:P.enabled&&a.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),a.jsxs("div",{children:[a.jsx("span",{className:M("text-sm font-medium",P.enabled?"text-text-primary":"text-text-secondary"),children:P.name}),a.jsx("span",{className:"ml-1.5 text-[10px] text-text-muted font-mono",children:P.command})]})]}),a.jsx(Ar,{value:P.count,onChange:_=>S(P.id,{count:_}),min:0,max:W,disabled:!P.enabled&&P.count===0})]},P.id)),C>0&&a.jsxs("div",{className:"pt-1.5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("div",{className:"flex-1 h-1.5 rounded-full bg-background border border-border overflow-hidden",children:a.jsx("div",{className:M("h-full rounded-full transition-all duration-200",C>W?"bg-amber-500":C===W?"bg-green-500":"bg-accent-blue"),style:{width:`${Math.min(100,C/W*100)}%`}})}),a.jsxs("span",{className:M("text-[10px] font-medium tabular-nums whitespace-nowrap",C>W?"text-amber-500":C===W?"text-green-500":"text-text-muted"),children:[C," / ",W," terminals"]})]}),C>W&&a.jsx("p",{className:"text-[10px] text-amber-500 px-0.5",children:"Extra agents will open in additional terminals"})]})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 px-4 py-3 border-t border-border bg-panel/50 rounded-b-xl sticky bottom-0",children:[a.jsx("button",{onClick:t,className:M("px-3 py-1.5 rounded-md text-xs font-medium","text-text-secondary hover:text-text-primary","hover:bg-surface-hover transition-colors"),children:"Cancel"}),a.jsx("button",{onClick:()=>n(s[o].id,i,f),className:M("px-3 py-1.5 rounded-md text-xs font-medium","bg-accent-blue text-white","hover:bg-accent-blue/90 transition-colors"),children:"Next"})]})]})]}):null}const jt=new Set(["node_modules",".git","build","dist",".next",".cache",".turbo","__pycache__",".pytest_cache","coverage",".nyc_output",".vscode",".idea","target","vendor","out",".output",".nuxt",".svelte-kit"]),rt=20,_r=8;async function cn(e,t,n=0){if(n>_r)return[];try{const r=await window.tauriAPI?.fs?.readDirectory(e,{showHidden:!1,ignoredPatterns:Array.from(jt)});if(!r)return[];const s=[],o=[];for(const i of r)if(i.isDirectory){const u=i.name.toLowerCase();!jt.has(u)&&!u.startsWith(".")&&o.push(cn(i.path,t,n+1))}else{const u=i.path.startsWith(t)?i.path.slice(t.length+1):i.path;s.push({path:i.path,name:i.name,relativePath:u,isOpen:!1,score:0})}const l=await Promise.all(o);return s.concat(...l)}catch{return[]}}function St(e,t){const n=e.toLowerCase(),r=t.toLowerCase();if(n.length===0)return 1;if(r.includes(n))return 10+n.length/r.length*5;let s=0,o=0,l=-2;for(let i=0;i<r.length&&o<n.length;i++)r[i]===n[o]&&(s+=1,i===l+1&&(s+=2),(i===0||r[i-1]==="/"||r[i-1]==="."||r[i-1]==="-"||r[i-1]==="_")&&(s+=3),l=i,o++);return o<n.length?0:s/n.length}function Or(e){const t=e.split(".").pop()?.toLowerCase()||"";return["ts","tsx","js","jsx"].includes(t)?a.jsx(tr,{size:14,className:"text-accent-blue flex-shrink-0"}):a.jsx(nn,{size:14,className:"text-text-muted flex-shrink-0"})}function Wr({isOpen:e,rootPath:t,onClose:n,onFileOpen:r,openFilePaths:s=[]}){const[o,l]=c.useState(""),[i,u]=c.useState([]),[p,d]=c.useState([]),[b,v]=c.useState(0),[j,k]=c.useState(!1),f=c.useRef(null),m=c.useRef(null);c.useEffect(()=>{!e||!t||(l(""),v(0),k(!0),cn(t,t).then(y=>{const S=new Set(s),C=y.map(z=>({...z,isOpen:S.has(z.path)}));u(C),d(C.slice(0,rt)),k(!1)}))},[e,t]),c.useEffect(()=>{if(e){const y=setTimeout(()=>f.current?.focus(),50);return()=>clearTimeout(y)}},[e]),c.useEffect(()=>{if(!o.trim()){const S=[...i].sort((C,z)=>C.isOpen!==z.isOpen?C.isOpen?-1:1:C.name.localeCompare(z.name));d(S.slice(0,rt)),v(0);return}const y=i.map(S=>({...S,score:Math.max(St(o,S.name),St(o,S.relativePath)*.8)})).filter(S=>S.score>0).sort((S,C)=>C.score-S.score);d(y.slice(0,rt)),v(0)},[o,i]),c.useEffect(()=>{const y=m.current;if(!y)return;const S=y.children[b];S&&S.scrollIntoView({block:"nearest"})},[b]);const g=c.useCallback(y=>{switch(y.key){case"ArrowDown":y.preventDefault(),v(S=>Math.min(S+1,p.length-1));break;case"ArrowUp":y.preventDefault(),v(S=>Math.max(S-1,0));break;case"Enter":y.preventDefault(),p[b]&&(r(p[b].path),n());break;case"Escape":y.preventDefault(),n();break}},[p,b,r,n]);return e?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-[15%]",onClick:y=>{y.target===y.currentTarget&&n()},children:[a.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),a.jsxs("div",{className:M("relative bg-surface border border-border rounded-xl shadow-2xl","w-[520px] max-h-[400px] overflow-hidden animate-slide-up"),children:[a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2.5 border-b border-border",children:[a.jsx(jr,{size:14,className:"text-text-muted flex-shrink-0"}),a.jsx("input",{ref:f,type:"text",value:o,onChange:y=>l(y.target.value),onKeyDown:g,placeholder:"Search files by name...",className:M("flex-1 bg-transparent text-sm text-text-primary","placeholder:text-text-muted/60 outline-none"),autoComplete:"off",spellCheck:!1}),o&&a.jsx("button",{onClick:()=>l(""),className:"p-0.5 rounded hover:bg-surface-hover text-text-muted",children:a.jsx(Ne,{size:12})})]}),a.jsx("div",{ref:m,className:"overflow-y-auto max-h-[340px]",children:j?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-accent-blue border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-xs text-text-muted",children:"Scanning files..."})]})}):p.length===0?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("span",{className:"text-xs text-text-muted",children:o?"No matching files found":"No files in workspace"})}):p.map((y,S)=>a.jsxs("div",{className:M("flex items-center gap-2 px-3 py-1.5 cursor-pointer","transition-colors",S===b?"bg-accent-blue/10 text-text-primary":"text-text-secondary hover:bg-surface-hover"),onClick:()=>{r(y.path),n()},onMouseEnter:()=>v(S),children:[Or(y.name),a.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[a.jsx("span",{className:"text-sm truncate",children:y.name}),a.jsx("span",{className:"text-[10px] text-text-muted truncate",children:y.relativePath})]}),y.isOpen&&a.jsx("span",{className:"text-[10px] text-accent-blue px-1.5 py-0.5 rounded bg-accent-blue/10 flex-shrink-0",children:"open"})]},y.path))}),a.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 border-t border-border bg-surface/50",children:[a.jsxs("span",{className:"text-[10px] text-text-muted",children:[p.length," file",p.length!==1?"s":""]}),a.jsxs("span",{className:"text-[10px] text-text-muted",children:[a.jsx("kbd",{className:"px-1 py-0.5 rounded bg-background border border-border text-[9px]",children:"Enter"})," to open",a.jsx("span",{className:"mx-1.5",children:"|"}),a.jsx("kbd",{className:"px-1 py-0.5 rounded bg-background border border-border text-[9px]",children:"Esc"})," to close"]})]})]})]}):null}const fe={gray:{bg:"#374151",hover:"#4b5563",text:"#f3f4f6",accent:"#9ca3af"},red:{bg:"#991b1b",hover:"#b91c1c",text:"#fef2f2",accent:"#f87171"},orange:{bg:"#9a3412",hover:"#c2410c",text:"#fff7ed",accent:"#fb923c"},amber:{bg:"#92400e",hover:"#b45309",text:"#fffbeb",accent:"#fbbf24"},yellow:{bg:"#854d0e",hover:"#a16207",text:"#fefce8",accent:"#facc15"},lime:{bg:"#3f6212",hover:"#4d7c0f",text:"#f7fee7",accent:"#a3e635"},green:{bg:"#166534",hover:"#15803d",text:"#f0fdf4",accent:"#4ade80"},emerald:{bg:"#065f46",hover:"#047857",text:"#ecfdf5",accent:"#34d399"},teal:{bg:"#115e59",hover:"#0f766e",text:"#f0fdfa",accent:"#2dd4bf"},cyan:{bg:"#155e75",hover:"#0e7490",text:"#ecfeff",accent:"#22d3ee"},sky:{bg:"#075985",hover:"#0369a1",text:"#f0f9ff",accent:"#38bdf8"},blue:{bg:"#1e40af",hover:"#1d4ed8",text:"#eff6ff",accent:"#3b82f6"},indigo:{bg:"#3730a3",hover:"#4338ca",text:"#eef2ff",accent:"#6366f1"},violet:{bg:"#5b21b6",hover:"#6d28d9",text:"#f5f3ff",accent:"#8b5cf6"},purple:{bg:"#6b21a8",hover:"#7c3aed",text:"#faf5ff",accent:"#a855f7"},fuchsia:{bg:"#86198f",hover:"#a21caf",text:"#fdf4ff",accent:"#d946ef"},pink:{bg:"#9d174d",hover:"#be185d",text:"#fdf2f8",accent:"#ec4899"},rose:{bg:"#9f1239",hover:"#be123c",text:"#fff1f2",accent:"#fb7185"}},Pt=["blue","emerald","violet","orange","pink","cyan","amber","indigo","green","rose","teal","purple","red","sky","fuchsia","lime","yellow","gray"];function at(e){return Pt[e%Pt.length]}function Nt(e){return`Workspace ${e+1}`}function Br({isOpen:e,onClose:t,onSelect:n,defaultColor:r,defaultName:s,position:o}){const[l,i]=c.useState(r),[u,p]=c.useState(s),d=c.useRef(null),b=c.useRef(null);c.useEffect(()=>{e&&(i(r),p(s),setTimeout(()=>{d.current?.focus(),d.current?.select()},50))},[e,r,s]),c.useEffect(()=>{if(!e)return;const f=m=>{b.current&&!b.current.contains(m.target)&&v()};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[e,l,u]);const v=()=>{n(l,u.trim()||s),t()},j=f=>{f.key==="Enter"?(f.preventDefault(),v()):f.key==="Escape"&&(f.preventDefault(),t())};if(!e)return null;const k=Object.keys(fe);return a.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-20",onClick:f=>{f.target===f.currentTarget&&v()},children:[a.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),a.jsxs("div",{ref:b,className:M("relative bg-surface border border-border rounded-xl shadow-2xl","w-[320px] animate-slide-up"),style:o?{position:"absolute",top:o.top,left:o.left}:void 0,children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"New Workspace"}),a.jsx("button",{onClick:t,className:"p-1 rounded hover:bg-surface-hover text-text-muted hover:text-text-primary transition-colors",children:a.jsx(Ne,{size:14})})]}),a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-text-muted mb-1.5 uppercase tracking-wide",children:"Name"}),a.jsx("input",{ref:d,type:"text",value:u,onChange:f=>p(f.target.value),onKeyDown:j,placeholder:s,className:M("w-full px-3 py-2 rounded-lg text-sm","bg-background border border-border","text-text-primary placeholder:text-text-muted","focus:outline-none focus:border-accent-blue focus:ring-1 focus:ring-accent-blue/30","transition-colors")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-text-muted mb-2 uppercase tracking-wide",children:"Color"}),a.jsx("div",{className:"grid grid-cols-9 gap-1.5",children:k.map(f=>{const m=fe[f],g=l===f;return a.jsx("button",{onClick:()=>i(f),className:M("w-7 h-7 rounded-md transition-all duration-100","flex items-center justify-center","hover:scale-110 active:scale-95",g&&"ring-2 ring-white ring-offset-2 ring-offset-surface"),style:{backgroundColor:m.bg},title:f.charAt(0).toUpperCase()+f.slice(1),children:g&&a.jsx(Jt,{size:14,className:"text-white"})},f)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-text-muted mb-1.5 uppercase tracking-wide",children:"Preview"}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg",style:{backgroundColor:fe[l].bg},children:[a.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:fe[l].accent}}),a.jsx("span",{className:"text-sm font-medium truncate",style:{color:fe[l].text},children:u||s})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 px-4 py-3 border-t border-border bg-panel/50 rounded-b-xl",children:[a.jsx("button",{onClick:t,className:M("px-3 py-1.5 rounded-md text-xs font-medium","text-text-secondary hover:text-text-primary","hover:bg-surface-hover transition-colors"),children:"Cancel"}),a.jsx("button",{onClick:v,className:M("px-3 py-1.5 rounded-md text-xs font-medium","bg-accent-blue text-white","hover:bg-accent-blue/90 transition-colors"),children:"Create"})]})]})]})}function Gr({isOpen:e,position:t,onClose:n,onRename:r,onColorChange:s,onCloseTab:o,currentColor:l}){const i=c.useRef(null),[u,p]=c.useState(!1);if(c.useEffect(()=>{if(!e){p(!1);return}const b=j=>{i.current&&!i.current.contains(j.target)&&n()},v=j=>{j.key==="Escape"&&n()};return document.addEventListener("mousedown",b),document.addEventListener("keydown",v),()=>{document.removeEventListener("mousedown",b),document.removeEventListener("keydown",v)}},[e,n]),!e)return null;const d=Object.keys(fe);return a.jsxs("div",{ref:i,className:M("fixed z-50 min-w-[180px] py-1.5","bg-surface border border-border rounded-lg shadow-xl","animate-slide-up"),style:{top:t.y,left:t.x},children:[a.jsxs("button",{onClick:()=>{r(),n()},className:M("w-full flex items-center gap-3 px-3 py-2 text-sm","text-text-secondary hover:text-text-primary","hover:bg-surface-hover transition-colors"),children:[a.jsx(yr,{size:14}),a.jsx("span",{children:"Rename"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>p(!u),className:M("w-full flex items-center gap-3 px-3 py-2 text-sm","text-text-secondary hover:text-text-primary","hover:bg-surface-hover transition-colors"),children:[a.jsx(gr,{size:14}),a.jsx("span",{children:"Change Color"}),a.jsx("div",{className:"ml-auto w-4 h-4 rounded-full",style:{backgroundColor:fe[l].bg}})]}),u&&a.jsx("div",{className:M("absolute left-full top-0 ml-1 p-2","bg-surface border border-border rounded-lg shadow-xl","w-[200px]"),children:a.jsx("div",{className:"grid grid-cols-6 gap-1",children:d.map(b=>{const v=fe[b],j=l===b;return a.jsx("button",{onClick:()=>{s(b),n()},className:M("w-7 h-7 rounded-md transition-all duration-100","flex items-center justify-center","hover:scale-110 active:scale-95",j&&"ring-2 ring-white ring-offset-1 ring-offset-surface"),style:{backgroundColor:v.bg},title:b.charAt(0).toUpperCase()+b.slice(1),children:j&&a.jsx(Jt,{size:12,className:"text-white"})},b)})})})]}),a.jsx("div",{className:"my-1.5 border-t border-border"}),a.jsxs("button",{onClick:()=>{o(),n()},className:M("w-full flex items-center gap-3 px-3 py-2 text-sm","text-accent-red/80 hover:text-accent-red","hover:bg-accent-red/10 transition-colors"),children:[a.jsx(Ne,{size:14}),a.jsx("span",{children:"Close Tab"})]})]})}function $r({tab:e,isActive:t,onClick:n,onClose:r,onRename:s,onColorChange:o,showCloseButton:l=!0,onDragStart:i,onDragOver:u,onDragEnd:p,onDrop:d,isDragOver:b=!1,dragPosition:v=null}){const[j,k]=c.useState(!1),[f,m]=c.useState(e.label),[g,y]=c.useState({isOpen:!1,x:0,y:0}),S=c.useRef(null),C=fe[e.color]||fe.blue;c.useEffect(()=>{j&&S.current&&(S.current.focus(),S.current.select())},[j]),c.useEffect(()=>{j||m(e.label)},[e.label,j]);const z=A=>{A.stopPropagation(),r()},T=()=>{f.trim()?s(f.trim()):m(e.label),k(!1)},E=A=>{A.key==="Enter"?T():A.key==="Escape"&&(m(e.label),k(!1))},W=A=>{A.preventDefault(),A.stopPropagation(),y({isOpen:!0,x:A.clientX,y:A.clientY})},G=A=>{A.key==="F2"&&!j&&(A.preventDefault(),k(!0))},U=()=>{y({isOpen:!1,x:0,y:0})},O=()=>{k(!0)},F=A=>{o?.(A)},K=A=>{if(j){A.preventDefault();return}i?.(A,e.id)},P=A=>{A.preventDefault(),u?.(A,e.id)},_=A=>{p?.(A)},B=A=>{A.preventDefault(),d?.(A,e.id)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative flex-shrink-0",children:[b&&v==="left"&&a.jsx("div",{className:"absolute left-0 top-1 bottom-1 w-0.5 bg-accent-blue rounded-full z-10 -translate-x-1"}),a.jsxs("button",{draggable:!j,onDragStart:K,onDragOver:P,onDragEnd:_,onDrop:B,onClick:n,onKeyDown:G,onContextMenu:W,className:M("group flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium","transition-all duration-100 whitespace-nowrap","min-w-[120px] max-w-[200px]","app-header-no-drag cursor-grab active:cursor-grabbing",t?"shadow-sm":"opacity-80 hover:opacity-100",b&&"opacity-50"),style:{backgroundColor:t?C.bg:`${C.bg}99`,color:C.text},title:`${e.path} (${e.terminalCount} terminal${e.terminalCount!==1?"s":""})`,children:[a.jsx(rn,{size:14,className:"flex-shrink-0 transition-colors",style:{color:C.accent}}),j?a.jsx("input",{ref:S,type:"text",value:f,onChange:A=>m(A.target.value),onBlur:T,onKeyDown:E,className:"flex-1 min-w-0 bg-transparent text-sm font-medium focus:outline-none app-header-no-double-click-maximize",style:{color:C.text},onClick:A=>A.stopPropagation()}):a.jsx("span",{className:"flex-1 truncate text-left",children:e.label}),e.terminalCount>1&&a.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full font-semibold",style:{backgroundColor:`${C.accent}33`,color:C.text},children:e.terminalCount}),l&&a.jsx("span",{role:"button",onClick:z,className:M("ml-0.5 p-0.5 rounded transition-all flex-shrink-0","cursor-pointer active:scale-95 active:opacity-90","opacity-0 group-hover:opacity-100","app-header-no-double-click-maximize",t&&"opacity-100"),style:{color:C.text},onMouseEnter:A=>{A.target.style.backgroundColor=`${C.hover}`},onMouseLeave:A=>{A.target.style.backgroundColor="transparent"},children:a.jsx(Ne,{size:12})})]}),b&&v==="right"&&a.jsx("div",{className:"absolute right-0 top-1 bottom-1 w-0.5 bg-accent-blue rounded-full z-10 translate-x-1"})]}),a.jsx(Gr,{isOpen:g.isOpen,position:{x:g.x,y:g.y},onClose:U,onRename:O,onColorChange:F,onCloseTab:r,currentColor:e.color})]})}const zt=new Set(["kanban","agents","prompts"]),Fr={kanban:"Kanban Board",agents:"Agents",prompts:"Prompts Library"},Hr=[{view:"terminal",icon:Er,label:"Terminal",shortcut:"⌘1"},{view:"kanban",icon:dr,label:"Kanban Board",shortcut:"⌘2"},{view:"agents",icon:sr,label:"Agents",shortcut:"⌘3"},{view:"prompts",icon:kr,label:"Prompts",shortcut:"⌘4"}];function Kr({activeView:e,onViewChange:t,onSettings:n,triggerElement:r}){const[s,o]=c.useState(!1),l=c.useRef(null),{isPro:i,requirePro:u}=Qt();c.useEffect(()=>{if(!s)return;const d=v=>{l.current&&!l.current.contains(v.target)&&o(!1)},b=v=>{v.key==="Escape"&&o(!1)};return document.addEventListener("mousedown",d),document.addEventListener("keydown",b),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("keydown",b)}},[s]);const p=d=>{if(zt.has(d)){const b=Fr[d]||d;if(!u(b)){o(!1);return}}t(d),o(!1)};return a.jsxs("div",{ref:l,className:"relative inline-flex",children:[r?a.jsx("button",{onClick:()=>o(!s),className:"app-header-no-drag app-header-no-double-click-maximize hover:opacity-80 transition-opacity",children:r}):a.jsx("button",{onClick:()=>o(!s),className:M("flex items-center justify-center w-6 h-6 rounded-md","text-text-muted hover:text-text-primary","hover:bg-surface-hover transition-all duration-150","app-header-no-drag app-header-no-double-click-maximize",s&&"bg-surface-hover text-text-primary"),children:a.jsx(en,{size:13,className:M("transition-transform duration-200",s&&"rotate-180")})}),s&&a.jsxs("div",{className:M("absolute top-full left-0 mt-2.5 z-[100]","w-[240px]","bg-surface/98 backdrop-blur-xl","border border-border rounded-xl","shadow-2xl shadow-black/50","overflow-hidden","animate-slide-up"),children:[a.jsx("div",{className:"absolute inset-x-0 top-0 h-px bg-white/[0.06] pointer-events-none"}),a.jsx("div",{className:"px-3 pt-2.5 pb-1.5",children:a.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-widest text-text-muted/50",children:"Navigate"})}),a.jsx("div",{className:"divide-y divide-border/40",children:Hr.map(d=>{const b=d.icon,v=e===d.view,j=zt.has(d.view)&&!i;return a.jsxs("button",{onClick:()=>p(d.view),className:M("relative w-full flex items-center gap-2.5 px-2.5 py-2 text-[13px]","transition-colors duration-100",v?"bg-accent-blue/10 text-text-primary":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"),children:[v&&a.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-5 rounded-r-full bg-accent-blue"}),a.jsx("div",{className:M("flex items-center justify-center w-[28px] h-[28px] rounded-md flex-shrink-0",v?"bg-accent-blue/15 text-accent-blue":"bg-background/60 text-text-muted"),children:a.jsx(b,{size:14,strokeWidth:1.75})}),a.jsx("span",{className:"flex-1 text-left font-medium",children:d.label}),j?a.jsxs("span",{className:M("flex items-center gap-1 text-[9px] font-semibold uppercase tracking-wider","px-1.5 py-0.5 rounded-md","bg-amber-500/10 text-amber-400 border border-amber-500/20"),children:[a.jsx(Xn,{size:8}),"Pro"]}):a.jsx("kbd",{className:M("text-[10px] px-1.5 py-0.5 rounded-md font-mono","bg-background/80 text-text-muted/60","border border-border/60","leading-none"),children:d.shortcut})]},d.view)})}),a.jsx("div",{className:"mx-2.5 my-1 border-t border-border/60"}),a.jsx("div",{className:"pb-1",children:a.jsxs("button",{onClick:()=>{n?.(),o(!1)},className:M("relative w-full flex items-center gap-2.5 px-2.5 py-2 text-[13px]","transition-colors duration-100",e==="settings"?"bg-accent-blue/10 text-text-primary":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"),children:[e==="settings"&&a.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-5 rounded-r-full bg-accent-blue"}),a.jsx("div",{className:M("flex items-center justify-center w-[28px] h-[28px] rounded-md flex-shrink-0",e==="settings"?"bg-accent-blue/15 text-accent-blue":"bg-background/60 text-text-muted"),children:a.jsx(Nr,{size:14,strokeWidth:1.75})}),a.jsx("span",{className:"flex-1 text-left font-medium",children:"Settings"}),a.jsx("kbd",{className:M("text-[10px] px-1.5 py-0.5 rounded-md font-mono","bg-background/80 text-text-muted/60","border border-border/60","leading-none"),children:"⌘,"})]})})]})]})}const Vr={kanban:{icon:fr,label:"Kanban"},agents:{icon:Jn,label:"Agents"},prompts:{icon:nn,label:"Prompts"},settings:{icon:sn,label:"Settings"}};function Ur(){const e=window.tauriAPI?.system?.platform;if(e)return e;const t=navigator.userAgent.toLowerCase();return t.includes("mac")?"darwin":t.includes("win")?"win32":"linux"}const Xr=pe.memo(function({activeView:t,onViewChange:n,onSettings:r}){const s=Vr[t],o=c.useMemo(()=>Ur()==="darwin",[]);return a.jsxs("div",{className:"flex items-center gap-1.5",children:[o&&a.jsx("div",{className:"w-[70px]"}),a.jsx(Kr,{activeView:t,onViewChange:n,onSettings:r,triggerElement:a.jsx("img",{src:qn,alt:"BridgeSpace",className:"h-6 w-6 object-contain"})}),s&&a.jsxs(a.Fragment,{children:[a.jsx(tn,{size:12,className:"text-text-muted/40 flex-shrink-0"}),a.jsxs("div",{className:M("flex items-center gap-1.5 px-2 py-0.5 rounded-md","text-[11px] font-medium tracking-wide","text-accent-blue bg-accent-blue/10","app-header-no-drag cursor-default select-none"),children:[a.jsx(s.icon,{size:12}),a.jsx("span",{children:s.label})]})]}),a.jsx("div",{className:"h-5 w-px bg-border mx-1"})]})}),qr=pe.memo(function({tabs:t,activeTabId:n,onTabClick:r,onCloseTab:s,onRenameTab:o,onColorChange:l,onNewTab:i,onReorderTabs:u}){const[p,d]=c.useState({draggedTabId:null,overTabId:null,dropPosition:null}),b=c.useCallback((f,m)=>{f.dataTransfer.effectAllowed="move",f.dataTransfer.setData("text/plain",m),setTimeout(()=>{d(g=>({...g,draggedTabId:m}))},0)},[]),v=c.useCallback((f,m)=>{if(f.preventDefault(),f.dataTransfer.dropEffect="move",!p.draggedTabId||p.draggedTabId===m){d(y=>({...y,overTabId:null,dropPosition:null}));return}const g=f.target.closest("button")?.getBoundingClientRect();if(g){const y=g.left+g.width/2,S=f.clientX<y?"left":"right";d(C=>({...C,overTabId:m,dropPosition:S}))}},[p.draggedTabId]),j=c.useCallback(()=>{d({draggedTabId:null,overTabId:null,dropPosition:null})},[]),k=c.useCallback((f,m)=>{f.preventDefault();const g=f.dataTransfer.getData("text/plain");if(g&&g!==m&&p.dropPosition){const y=p.dropPosition==="left"?"before":"after";u?.(g,m,y)}d({draggedTabId:null,overTabId:null,dropPosition:null})},[p.dropPosition,u]);return a.jsxs("div",{className:M("flex items-center h-full gap-0.5 px-2 overflow-x-auto","scrollbar-none"),children:[t.length===0?a.jsx("span",{className:"text-xs text-text-muted px-2",children:"No workspaces open"}):t.map(f=>a.jsx($r,{tab:f,isActive:f.id===n,onClick:()=>r(f.id),onClose:()=>s(f.id),onRename:m=>o(f.id,m),onColorChange:m=>l(f.id,m),showCloseButton:t.length>1,onDragStart:b,onDragOver:v,onDragEnd:j,onDrop:k,isDragOver:p.overTabId===f.id,dragPosition:p.overTabId===f.id?p.dropPosition:null},f.id)),a.jsx("button",{onClick:i,className:M("flex items-center justify-center w-8 h-8 rounded-md flex-shrink-0","text-text-muted hover:text-text-primary hover:bg-surface-hover","transition-colors ml-1 app-header-no-drag app-header-no-double-click-maximize"),title:"New Tab (⌘T)",children:a.jsx(ct,{size:16})})]})});function Yr({content:e,children:t,side:n="bottom",sideOffset:r=8,delayMs:s=300,className:o}){const[l,i]=c.useState(!1),[u,p]=c.useState(null),d=c.useRef(),b=c.useRef(null),v=c.useCallback(()=>{const g=b.current;if(!g)return null;const y=g.getBoundingClientRect(),S=y.left+y.width/2,C=y.top+y.height/2;switch(n){case"top":return{top:y.top-r,left:S};case"bottom":return{top:y.bottom+r,left:S};case"left":return{top:C,left:y.left-r};case"right":return{top:C,left:y.right+r};default:return{top:y.bottom+r,left:S}}},[n,r]),j=()=>{d.current=setTimeout(()=>{const g=v();g&&(p(g),i(!0))},s)},k=()=>{d.current&&clearTimeout(d.current),i(!1),p(null)};c.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]);const f={top:"bottom center",bottom:"top center",left:"right center",right:"left center"},m={top:"-translate-x-1/2 -translate-y-full",bottom:"-translate-x-1/2",left:"-translate-x-full -translate-y-1/2",right:"-translate-y-1/2"};return a.jsxs("div",{ref:b,className:"relative inline-flex",onMouseEnter:j,onMouseLeave:k,children:[t,l&&u&&Zt.createPortal(a.jsxs("div",{role:"tooltip",className:M("fixed pointer-events-none","px-3 py-1.5 rounded-lg","bg-surface/95 backdrop-blur-md","border border-border/60","text-xs text-text-primary font-medium whitespace-nowrap tracking-wide","shadow-xl shadow-black/25","animate-in fade-in-0 zoom-in-95 duration-200",m[n],o),style:{zIndex:99999,top:u.top,left:u.left,transformOrigin:f[n]},children:[a.jsx("span",{className:"absolute inset-0 rounded-lg bg-gradient-to-b from-white/[0.06] to-transparent pointer-events-none"}),a.jsx("span",{className:"relative",children:e})]}),document.body)]})}function Jr(){const e=window.tauriAPI?.system?.platform;if(e)return e;const t=navigator.userAgent.toLowerCase();return t.includes("mac")?"darwin":t.includes("win")?"win32":"linux"}const Qr=pe.memo(function({onSettings:t}){const[n,r]=c.useState(!1),s=c.useMemo(()=>Jr()==="win32",[]);return c.useEffect(()=>{if(!s||!window.tauriAPI?.window)return;let o=!0;window.tauriAPI.window.isMaximized().then(i=>{o&&r(i)}).catch(()=>{});const l=window.tauriAPI.window.onMaximizedChange(i=>{r(i)});return()=>{o=!1,l()}},[s]),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yr,{content:"Settings",children:a.jsx("button",{onClick:t,className:M("flex items-center justify-center w-8 h-8 rounded-md","text-text-muted hover:text-text-primary hover:bg-surface-hover","transition-colors app-header-no-drag app-header-no-double-click-maximize"),children:a.jsx(sn,{size:16})})}),s&&a.jsxs("div",{className:"ml-2 flex items-center overflow-hidden rounded-md border border-border/70 bg-surface app-header-no-drag app-header-no-double-click-maximize",children:[a.jsx("button",{onClick:()=>window.tauriAPI?.window?.minimize(),className:M("flex h-8 w-9 items-center justify-center","text-text-muted hover:bg-surface-hover hover:text-text-primary","transition-colors app-header-no-drag app-header-no-double-click-maximize"),title:"Minimize","aria-label":"Minimize window",children:a.jsx(an,{size:14})}),a.jsx("button",{onClick:()=>window.tauriAPI?.window?.maximize(),className:M("flex h-8 w-9 items-center justify-center","text-text-muted hover:bg-surface-hover hover:text-text-primary","transition-colors app-header-no-drag app-header-no-double-click-maximize"),title:n?"Restore":"Maximize","aria-label":n?"Restore window":"Maximize window",children:n?a.jsx(rr,{size:13}):a.jsx(Lr,{size:13})}),a.jsx("button",{onClick:()=>window.tauriAPI?.window?.close(),className:M("flex h-8 w-9 items-center justify-center","text-text-muted hover:bg-accent-red/20 hover:text-accent-red","transition-colors app-header-no-drag app-header-no-double-click-maximize"),title:"Close","aria-label":"Close window",children:a.jsx(Ne,{size:14})})]})]})}),Zr=[".app-header-no-double-click-maximize","input","textarea","select",'[contenteditable="true"]'].join(", "),ea=["input","textarea","select",'[contenteditable="true"]'].join(", "),Et=4;function ta(){const e=window.tauriAPI?.system?.platform;if(e)return e;const t=navigator.userAgent.toLowerCase();return t.includes("mac")?"darwin":t.includes("win")?"win32":"linux"}const na=pe.memo(function({activeView:t,onViewChange:n,tabs:r,activeTabId:s,onTabClick:o,onCloseTab:l,onRenameTab:i,onColorChange:u,onNewTab:p,onReorderTabs:d,onSettings:b,isDraggingPane:v,onPaneDropToNewWorkspace:j}){const k=c.useMemo(()=>ta(),[]),f=k==="darwin"||k==="win32",m=c.useRef({active:!1,startedDragging:!1,startX:0,startY:0}),g=c.useRef(!1),y=()=>{m.current={active:!1,startedDragging:!1,startX:0,startY:0}},S=G=>{!f||v||G.button!==0||G.target?.closest(Zr)||window.tauriAPI?.window?.maximize()},C=G=>{!f||v||G.button!==0||G.target?.closest(ea)||(m.current={active:!0,startedDragging:!1,startX:G.clientX,startY:G.clientY})},z=G=>{const U=m.current;if(!U.active||U.startedDragging)return;if(!(G.buttons&1)){y();return}const O=Math.abs(G.clientX-U.startX),F=Math.abs(G.clientY-U.startY);O<Et&&F<Et||(U.startedDragging=!0,g.current=!0,G.preventDefault(),window.tauriAPI?.window?.startDragging())},T=()=>{const G=m.current.startedDragging;y(),G&&window.setTimeout(()=>{g.current=!1},0)},E=G=>{G.buttons&1||y()},W=G=>{g.current&&(G.preventDefault(),G.stopPropagation(),g.current=!1)};return a.jsxs("header",{"data-tauri-drag-region":v?void 0:"",className:M("relative grid grid-cols-[auto_1fr_auto] items-center w-full h-11 px-3","bg-surface border-b border-border",!v&&"app-header-drag"),onMouseDownCapture:C,onMouseMoveCapture:z,onMouseUpCapture:T,onMouseLeave:E,onClickCapture:W,onDoubleClickCapture:S,children:[a.jsx(Xr,{activeView:t,onViewChange:n,onSettings:b}),a.jsx(qr,{tabs:r,activeTabId:s,onTabClick:o,onCloseTab:l,onRenameTab:i,onColorChange:u,onNewTab:p,onReorderTabs:d}),a.jsx(Qr,{onSettings:b})]})});function ra(e,t){const n=getComputedStyle(e),r=parseFloat(n.fontSize);return t*r}function aa(e,t){const n=getComputedStyle(e.ownerDocument.body),r=parseFloat(n.fontSize);return t*r}function sa(e){return e/100*window.innerHeight}function oa(e){return e/100*window.innerWidth}function ia(e){switch(typeof e){case"number":return[e,"px"];case"string":{const t=parseFloat(e);return e.endsWith("%")?[t,"%"]:e.endsWith("px")?[t,"px"]:e.endsWith("rem")?[t,"rem"]:e.endsWith("em")?[t,"em"]:e.endsWith("vh")?[t,"vh"]:e.endsWith("vw")?[t,"vw"]:[t,"%"]}}}function Ge({groupSize:e,panelElement:t,styleProp:n}){let r;const[s,o]=ia(n);switch(o){case"%":{r=s/100*e;break}case"px":{r=s;break}case"rem":{r=aa(t,s);break}case"em":{r=ra(t,s);break}case"vh":{r=sa(s);break}case"vw":{r=oa(s);break}}return r}function ce(e){return parseFloat(e.toFixed(3))}function De({group:e}){const{orientation:t,panels:n}=e;return n.reduce((r,s)=>(r+=t==="horizontal"?s.element.offsetWidth:s.element.offsetHeight,r),0)}function it(e){const{panels:t}=e,n=De({group:e});return n===0?t.map(r=>({collapsedSize:0,collapsible:r.panelConstraints.collapsible===!0,defaultSize:void 0,disabled:r.panelConstraints.disabled,minSize:0,maxSize:100,panelId:r.id})):t.map(r=>{const{element:s,panelConstraints:o}=r;let l=0;if(o.collapsedSize!==void 0){const d=Ge({groupSize:n,panelElement:s,styleProp:o.collapsedSize});l=ce(d/n*100)}let i;if(o.defaultSize!==void 0){const d=Ge({groupSize:n,panelElement:s,styleProp:o.defaultSize});i=ce(d/n*100)}let u=0;if(o.minSize!==void 0){const d=Ge({groupSize:n,panelElement:s,styleProp:o.minSize});u=ce(d/n*100)}let p=100;if(o.maxSize!==void 0){const d=Ge({groupSize:n,panelElement:s,styleProp:o.maxSize});p=ce(d/n*100)}return{collapsedSize:l,collapsible:o.collapsible===!0,defaultSize:i,disabled:o.disabled,minSize:u,maxSize:p,panelId:r.id}})}function V(e,t="Assertion error"){if(!e)throw Error(t)}function lt(e,t){return Array.from(t).sort(e==="horizontal"?la:ca)}function la(e,t){const n=e.element.offsetLeft-t.element.offsetLeft;return n!==0?n:e.element.offsetWidth-t.element.offsetWidth}function ca(e,t){const n=e.element.offsetTop-t.element.offsetTop;return n!==0?n:e.element.offsetHeight-t.element.offsetHeight}function dn(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function un(e,t){return{x:e.x>=t.left&&e.x<=t.right?0:Math.min(Math.abs(e.x-t.left),Math.abs(e.x-t.right)),y:e.y>=t.top&&e.y<=t.bottom?0:Math.min(Math.abs(e.y-t.top),Math.abs(e.y-t.bottom))}}function da({orientation:e,rects:t,targetRect:n}){const r={x:n.x+n.width/2,y:n.y+n.height/2};let s,o=Number.MAX_VALUE;for(const l of t){const{x:i,y:u}=un(r,l),p=e==="horizontal"?i:u;p<o&&(o=p,s=l)}return V(s,"No rect found"),s}let $e;function ua(){return $e===void 0&&(typeof matchMedia=="function"?$e=!!matchMedia("(pointer:coarse)").matches:$e=!1),$e}function fn(e){const{element:t,orientation:n,panels:r,separators:s}=e,o=lt(n,Array.from(t.children).filter(dn).map(k=>({element:k}))).map(({element:k})=>k),l=[];let i=!1,u=!1,p=-1,d=-1,b=0,v,j=[];{let k=-1;for(const f of o)f.hasAttribute("data-panel")&&(k++,f.ariaDisabled===null&&(b++,p===-1&&(p=k),d=k))}if(b>1){let k=-1;for(const f of o)if(f.hasAttribute("data-panel")){k++;const m=r.find(g=>g.element===f);if(m){if(v){const g=v.element.getBoundingClientRect(),y=f.getBoundingClientRect();let S;if(u){const C=n==="horizontal"?new DOMRect(g.right,g.top,0,g.height):new DOMRect(g.left,g.bottom,g.width,0),z=n==="horizontal"?new DOMRect(y.left,y.top,0,y.height):new DOMRect(y.left,y.top,y.width,0);switch(j.length){case 0:{S=[C,z];break}case 1:{const T=j[0],E=da({orientation:n,rects:[g,y],targetRect:T.element.getBoundingClientRect()});S=[T,E===g?z:C];break}default:{S=j;break}}}else j.length?S=j:S=[n==="horizontal"?new DOMRect(g.right,y.top,y.left-g.right,y.height):new DOMRect(y.left,g.bottom,y.width,y.top-g.bottom)];for(const C of S){let z="width"in C?C:C.element.getBoundingClientRect();const T=ua()?e.resizeTargetMinimumSize.coarse:e.resizeTargetMinimumSize.fine;if(z.width<T){const W=T-z.width;z=new DOMRect(z.x-W/2,z.y,z.width+W,z.height)}if(z.height<T){const W=T-z.height;z=new DOMRect(z.x,z.y-W/2,z.width,z.height+W)}const E=k<=p||k>d;!i&&!E&&l.push({group:e,groupSize:De({group:e}),panels:[v,m],separator:"width"in C?void 0:C,rect:z}),i=!1}}u=!1,v=m,j=[]}}else if(f.hasAttribute("data-separator")){f.ariaDisabled!==null&&(i=!0);const m=s.find(g=>g.element===f);m?j.push(m):(v=void 0,j=[])}else u=!0}return l}class fa{#e={};addListener(t,n){const r=this.#e[t];return r===void 0?this.#e[t]=[n]:r.includes(n)||r.push(n),()=>{this.removeListener(t,n)}}emit(t,n){const r=this.#e[t];if(r!==void 0)if(r.length===1)r[0].call(null,n);else{let s=!1,o=null;const l=Array.from(r);for(let i=0;i<l.length;i++){const u=l[i];try{u.call(null,n)}catch(p){o===null&&(s=!0,o=p)}}if(s)throw o}}removeAllListeners(){this.#e={}}removeListener(t,n){const r=this.#e[t];if(r!==void 0){const s=r.indexOf(n);s>=0&&r.splice(s,1)}}}function te(e,t,n=0){return Math.abs(ce(e)-ce(t))<=n}let se={cursorFlags:0,interactionState:{state:"inactive"},mountedGroups:new Map};const be=new fa;function ne(){return se}function re(e){const t=typeof e=="function"?e(se):e;if(se===t)return se;const n=se;return se={...se,...t},t.cursorFlags!==void 0&&be.emit("cursorFlagsChange",se.cursorFlags),t.interactionState!==void 0&&be.emit("interactionStateChange",se.interactionState),t.mountedGroups!==void 0&&(se.mountedGroups.forEach((r,s)=>{r.derivedPanelConstraints.forEach(o=>{if(o.collapsible){const{layout:l}=n.mountedGroups.get(s)??{};if(l){const i=te(o.collapsedSize,r.layout[o.panelId]),u=te(o.collapsedSize,l[o.panelId]);i&&!u&&(s.inMemoryLastExpandedPanelSizes[o.panelId]=l[o.panelId])}}})}),be.emit("mountedGroupsChange",se.mountedGroups)),se}function pa(e,t,n){let r,s={x:1/0,y:1/0};for(const o of t){const l=un(n,o.rect);switch(e){case"horizontal":{l.x<=s.x&&(r=o,s=l);break}case"vertical":{l.y<=s.y&&(r=o,s=l);break}}}return r?{distance:s,hitRegion:r}:void 0}function ma(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function ha(e,t){if(e===t)throw new Error("Cannot compare node with itself");const n={a:Tt(e),b:Tt(t)};let r;for(;n.a.at(-1)===n.b.at(-1);)r=n.a.pop(),n.b.pop();V(r,"Stacking order can only be calculated for elements with a common ancestor");const s={a:Lt(It(n.a)),b:Lt(It(n.b))};if(s.a===s.b){const o=r.childNodes,l={a:n.a.at(-1),b:n.b.at(-1)};let i=o.length;for(;i--;){const u=o[i];if(u===l.a)return 1;if(u===l.b)return-1}}return Math.sign(s.a-s.b)}const xa=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function ga(e){const t=getComputedStyle(pn(e)??e).display;return t==="flex"||t==="inline-flex"}function ba(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||ga(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||xa.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function It(e){let t=e.length;for(;t--;){const n=e[t];if(V(n,"Missing node"),ba(n))return n}return null}function Lt(e){return e&&Number(getComputedStyle(e).zIndex)||0}function Tt(e){const t=[];for(;e;)t.push(e),e=pn(e);return t}function pn(e){const{parentNode:t}=e;return ma(t)?t.host:t}function ya(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function va({groupElement:e,hitRegion:t,pointerEventTarget:n}){if(!dn(n)||n.contains(e)||e.contains(n))return!0;if(ha(n,e)>0){let r=n;for(;r;){if(r.contains(e))return!0;if(ya(r.getBoundingClientRect(),t))return!1;r=r.parentElement}}return!0}function dt(e,t){const n=[];return t.forEach((r,s)=>{if(s.disabled)return;const o=fn(s),l=pa(s.orientation,o,{x:e.clientX,y:e.clientY});l&&l.distance.x<=0&&l.distance.y<=0&&va({groupElement:s.element,hitRegion:l.hitRegion.rect,pointerEventTarget:e.target})&&n.push(l.hitRegion)}),n}function wa(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function ue(e,t){return te(e,t)?0:e>t?1:-1}function Te({overrideDisabledPanels:e,panelConstraints:t,prevSize:n,size:r}){const{collapsedSize:s=0,collapsible:o,disabled:l,maxSize:i=100,minSize:u=0}=t;if(l&&!e)return n;if(ue(r,u)<0)if(o){const p=(s+u)/2;ue(r,p)<0?r=s:r=u}else r=u;return r=Math.min(i,r),r=ce(r),r}function _e({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:r,prevLayout:s,trigger:o}){if(te(e,0))return t;const l=o==="imperative-api",i=Object.values(t),u=Object.values(s),p=[...i],[d,b]=r;V(d!=null,"Invalid first pivot index"),V(b!=null,"Invalid second pivot index");let v=0;switch(o){case"keyboard":{{const f=e<0?b:d,m=n[f];V(m,`Panel constraints not found for index ${f}`);const{collapsedSize:g=0,collapsible:y,minSize:S=0}=m;if(y){const C=i[f];if(V(C!=null,`Previous layout not found for panel index ${f}`),te(C,g)){const z=S-C;ue(z,Math.abs(e))>0&&(e=e<0?0-z:z)}}}{const f=e<0?d:b,m=n[f];V(m,`No panel constraints found for index ${f}`);const{collapsedSize:g=0,collapsible:y,minSize:S=0}=m;if(y){const C=i[f];if(V(C!=null,`Previous layout not found for panel index ${f}`),te(C,S)){const z=C-g;ue(z,Math.abs(e))>0&&(e=e<0?0-z:z)}}}break}default:{const f=e<0?b:d,m=n[f];V(m,`Panel constraints not found for index ${f}`);const g=i[f],{collapsible:y,collapsedSize:S,minSize:C}=m;if(y&&ue(g,C)<0)if(e>0){const z=C-S,T=z/2,E=g+e;ue(E,C)<0&&(e=ue(e,T)<=0?0:z)}else{const z=C-S,T=100-z/2,E=g-e;ue(E,C)<0&&(e=ue(100+e,T)>0?0:-z)}break}}{const f=e<0?1:-1;let m=e<0?b:d,g=0;for(;;){const S=i[m];V(S!=null,`Previous layout not found for panel index ${m}`);const C=Te({overrideDisabledPanels:l,panelConstraints:n[m],prevSize:S,size:100})-S;if(g+=C,m+=f,m<0||m>=n.length)break}const y=Math.min(Math.abs(e),Math.abs(g));e=e<0?0-y:y}{let f=e<0?d:b;for(;f>=0&&f<n.length;){const m=Math.abs(e)-Math.abs(v),g=i[f];V(g!=null,`Previous layout not found for panel index ${f}`);const y=g-m,S=Te({overrideDisabledPanels:l,panelConstraints:n[f],prevSize:g,size:y});if(!te(g,S)&&(v+=g-S,p[f]=S,v.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?f--:f++}}if(wa(u,p))return s;{const f=e<0?b:d,m=i[f];V(m!=null,`Previous layout not found for panel index ${f}`);const g=m+v,y=Te({overrideDisabledPanels:l,panelConstraints:n[f],prevSize:m,size:g});if(p[f]=y,!te(y,g)){let S=g-y,C=e<0?b:d;for(;C>=0&&C<n.length;){const z=p[C];V(z!=null,`Previous layout not found for panel index ${C}`);const T=z+S,E=Te({overrideDisabledPanels:l,panelConstraints:n[C],prevSize:z,size:T});if(te(z,E)||(S-=E-z,p[C]=E),te(S,0))break;e>0?C--:C++}}}const j=Object.values(p).reduce((f,m)=>m+f,0);if(!te(j,100,.1))return s;const k=Object.keys(s);return p.reduce((f,m,g)=>(f[k[g]]=m,f),{})}function je(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(t[n]===void 0||ue(e[n],t[n])!==0)return!1;return!0}function Se({layout:e,panelConstraints:t}){const n=Object.values(e),r=[...n],s=r.reduce((i,u)=>i+u,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(i=>`${i}%`).join(", ")}`);if(!te(s,100)&&r.length>0)for(let i=0;i<t.length;i++){const u=r[i];V(u!=null,`No layout data found for index ${i}`);const p=100/s*u;r[i]=p}let o=0;for(let i=0;i<t.length;i++){const u=n[i];V(u!=null,`No layout data found for index ${i}`);const p=r[i];V(p!=null,`No layout data found for index ${i}`);const d=Te({overrideDisabledPanels:!0,panelConstraints:t[i],prevSize:u,size:p});p!=d&&(o+=p-d,r[i]=d)}if(!te(o,0))for(let i=0;i<t.length;i++){const u=r[i];V(u!=null,`No layout data found for index ${i}`);const p=u+o,d=Te({overrideDisabledPanels:!0,panelConstraints:t[i],prevSize:u,size:p});if(u!==d&&(o-=d-u,r[i]=d,te(o,0)))break}const l=Object.keys(e);return r.reduce((i,u,p)=>(i[l[p]]=u,i),{})}function mn({groupId:e,panelId:t}){const n=()=>{const{mountedGroups:i}=ne();for(const[u,{defaultLayoutDeferred:p,derivedPanelConstraints:d,layout:b,separatorToPanels:v}]of i)if(u.id===e)return{defaultLayoutDeferred:p,derivedPanelConstraints:d,group:u,layout:b,separatorToPanels:v};throw Error(`Group ${e} not found`)},r=()=>{const i=n().derivedPanelConstraints.find(u=>u.panelId===t);if(i!==void 0)return i;throw Error(`Panel constraints not found for Panel ${t}`)},s=()=>{const i=n().group.panels.find(u=>u.id===t);if(i!==void 0)return i;throw Error(`Layout not found for Panel ${t}`)},o=()=>{const i=n().layout[t];if(i!==void 0)return i;throw Error(`Layout not found for Panel ${t}`)},l=i=>{const u=o();if(i===u)return;const{defaultLayoutDeferred:p,derivedPanelConstraints:d,group:b,layout:v,separatorToPanels:j}=n(),k=b.panels.findIndex(y=>y.id===t),f=k===b.panels.length-1,m=_e({delta:f?u-i:i-u,initialLayout:v,panelConstraints:d,pivotIndices:f?[k-1,k]:[k,k+1],prevLayout:v,trigger:"imperative-api"}),g=Se({layout:m,panelConstraints:d});je(v,g)||re(y=>({mountedGroups:new Map(y.mountedGroups).set(b,{defaultLayoutDeferred:p,derivedPanelConstraints:d,layout:g,separatorToPanels:j})}))};return{collapse:()=>{const{collapsible:i,collapsedSize:u}=r(),{mutableValues:p}=s(),d=o();i&&d!==u&&(p.expandToSize=d,l(u))},expand:()=>{const{collapsible:i,collapsedSize:u,minSize:p}=r(),{mutableValues:d}=s(),b=o();if(i&&b===u){let v=d.expandToSize??p;v===0&&(v=1),l(v)}},getSize:()=>{const{group:i}=n(),u=o(),{element:p}=s(),d=i.orientation==="horizontal"?p.offsetWidth:p.offsetHeight;return{asPercentage:u,inPixels:d}},isCollapsed:()=>{const{collapsible:i,collapsedSize:u}=r(),p=o();return i&&te(u,p)},resize:i=>{if(o()!==i){let u;switch(typeof i){case"number":{const{group:p}=n(),d=De({group:p});u=ce(i/d*100);break}case"string":{u=parseFloat(i);break}}l(u)}}}}function Dt(e){if(e.defaultPrevented)return;const{mountedGroups:t}=ne();dt(e,t).forEach(n=>{if(n.separator){const r=n.panels.find(s=>s.panelConstraints.defaultSize!==void 0);if(r){const s=r.panelConstraints.defaultSize,o=mn({groupId:n.group.id,panelId:r.id});o&&s!==void 0&&(o.resize(s),e.preventDefault())}}})}function Ve(e){const{mountedGroups:t}=ne();for(const[n]of t)if(n.separators.some(r=>r.element===e))return n;throw Error("Could not find parent Group for separator element")}function hn({groupId:e}){const t=()=>{const{mountedGroups:n}=ne();for(const[r,s]of n)if(r.id===e)return{group:r,...s};throw Error(`Could not find Group with id "${e}"`)};return{getLayout(){const{defaultLayoutDeferred:n,layout:r}=t();return n?{}:r},setLayout(n){const{defaultLayoutDeferred:r,derivedPanelConstraints:s,group:o,layout:l,separatorToPanels:i}=t(),u=Se({layout:n,panelConstraints:s});if(r)return l;if(!je(l,u)){re(d=>({mountedGroups:new Map(d.mountedGroups).set(o,{defaultLayoutDeferred:r,derivedPanelConstraints:s,layout:u,separatorToPanels:i})}));const p=o.panels.map(({id:d})=>d).join(",");o.inMemoryLayouts[p]=u}return u}}}function xn(e){const{mountedGroups:t}=ne(),n=t.get(e);return V(n,`Mounted Group ${e.id} not found`),n}function Ce(e,t){const n=Ve(e),r=xn(n),s=n.separators.find(d=>d.element===e);V(s,"Matching separator not found");const o=r.separatorToPanels.get(s);V(o,"Matching panels not found");const l=o.map(d=>n.panels.indexOf(d)),i=hn({groupId:n.id}).getLayout(),u=_e({delta:t,initialLayout:i,panelConstraints:r.derivedPanelConstraints,pivotIndices:l,prevLayout:i,trigger:"keyboard"}),p=Se({layout:u,panelConstraints:r.derivedPanelConstraints});je(i,p)||re(d=>({mountedGroups:new Map(d.mountedGroups).set(n,{defaultLayoutDeferred:r.defaultLayoutDeferred,derivedPanelConstraints:r.derivedPanelConstraints,layout:p,separatorToPanels:r.separatorToPanels})}))}function Mt(e){if(e.defaultPrevented)return;const t=e.currentTarget,n=Ve(t);if(!n.disabled)switch(e.key){case"ArrowDown":{e.preventDefault(),n.orientation==="vertical"&&Ce(t,5);break}case"ArrowLeft":{e.preventDefault(),n.orientation==="horizontal"&&Ce(t,-5);break}case"ArrowRight":{e.preventDefault(),n.orientation==="horizontal"&&Ce(t,5);break}case"ArrowUp":{e.preventDefault(),n.orientation==="vertical"&&Ce(t,-5);break}case"End":{e.preventDefault(),Ce(t,100);break}case"Enter":{e.preventDefault();const r=Ve(t),{derivedPanelConstraints:s,layout:o,separatorToPanels:l}=xn(r),i=r.separators.find(b=>b.element===t);V(i,"Matching separator not found");const u=l.get(i);V(u,"Matching panels not found");const p=u[0],d=s.find(b=>b.panelId===p.id);if(V(d,"Panel metadata not found"),d.collapsible){const b=o[p.id],v=d.collapsedSize===b?r.inMemoryLastExpandedPanelSizes[p.id]??d.minSize:d.collapsedSize;Ce(t,v-b)}break}case"F6":{e.preventDefault();const r=Ve(t).separators.map(l=>l.element),s=Array.from(r).findIndex(l=>l===e.currentTarget);V(s!==null,"Index not found");const o=e.shiftKey?s>0?s-1:r.length-1:s+1<r.length?s+1:0;r[o].focus();break}case"Home":{e.preventDefault(),Ce(t,-100);break}}}function At(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{mountedGroups:t}=ne(),n=dt(e,t),r=new Map;let s=!1;n.forEach(o=>{o.separator&&(s||(s=!0,o.separator.element.focus()));const l=t.get(o.group);l&&r.set(o.group,l.layout)}),re({interactionState:{hitRegions:n,initialLayoutMap:r,pointerDownAtPoint:{x:e.clientX,y:e.clientY},state:"active"}}),n.length&&e.preventDefault()}const ka=e=>e,st=()=>{},gn=1,bn=2,yn=4,vn=8,Rt=3,_t=12;let Fe;function Ot(){return Fe===void 0&&(Fe=!1,typeof window<"u"&&(window.navigator.userAgent.includes("Chrome")||window.navigator.userAgent.includes("Firefox"))&&(Fe=!0)),Fe}function Ca({cursorFlags:e,groups:t,state:n}){let r=0,s=0;switch(n){case"active":case"hover":t.forEach(o=>{if(!o.disableCursor)switch(o.orientation){case"horizontal":{r++;break}case"vertical":{s++;break}}})}if(!(r===0&&s===0)){switch(n){case"active":{if(e&&Ot()){const o=(e&gn)!==0,l=(e&bn)!==0,i=(e&yn)!==0,u=(e&vn)!==0;if(o)return i?"se-resize":u?"ne-resize":"e-resize";if(l)return i?"sw-resize":u?"nw-resize":"w-resize";if(i)return"s-resize";if(u)return"n-resize"}break}}return Ot()?r>0&&s>0?"move":r>0?"ew-resize":"ns-resize":r>0&&s>0?"grab":r>0?"col-resize":"row-resize"}}const Wt=new WeakMap;function ut(e){if(e.defaultView===null||e.defaultView===void 0)return;let{prevStyle:t,styleSheet:n}=Wt.get(e)??{};n===void 0&&(n=new e.defaultView.CSSStyleSheet,e.adoptedStyleSheets.push(n));const{cursorFlags:r,interactionState:s}=ne();switch(s.state){case"active":case"hover":{const o=Ca({cursorFlags:r,groups:s.hitRegions.map(i=>i.group),state:s.state}),l=`*, *:hover {cursor: ${o} !important; }`;if(t===l)return;t=l,o?n.cssRules.length===0?n.insertRule(l):n.replaceSync(l):n.cssRules.length===1&&n.deleteRule(0);break}case"inactive":{t=void 0,n.cssRules.length===1&&n.deleteRule(0);break}}Wt.set(e,{prevStyle:t,styleSheet:n})}function wn({document:e,event:t,hitRegions:n,initialLayoutMap:r,mountedGroups:s,pointerDownAtPoint:o,prevCursorFlags:l}){let i=0;const u=new Map(s);n.forEach(d=>{const{group:b,groupSize:v}=d,{disableCursor:j,orientation:k,panels:f}=b;let m=0;o?k==="horizontal"?m=(t.clientX-o.x)/v*100:m=(t.clientY-o.y)/v*100:k==="horizontal"?m=t.clientX<0?-100:100:m=t.clientY<0?-100:100;const g=r.get(b),{defaultLayoutDeferred:y,derivedPanelConstraints:S,layout:C,separatorToPanels:z}=s.get(b)??{defaultLayoutDeferred:!1};if(S&&g&&C&&z){const T=_e({delta:m,initialLayout:g,panelConstraints:S,pivotIndices:d.panels.map(E=>f.indexOf(E)),prevLayout:C,trigger:"mouse-or-touch"});if(je(T,C)){if(m!==0&&!j)switch(k){case"horizontal":{i|=m<0?gn:bn;break}case"vertical":{i|=m<0?yn:vn;break}}}else{u.set(d.group,{defaultLayoutDeferred:y,derivedPanelConstraints:S,layout:T,separatorToPanels:z});const E=d.group.panels.map(({id:W})=>W).join(",");d.group.inMemoryLayouts[E]=T}}});let p=0;t.movementX===0?p|=l&Rt:p|=i&Rt,t.movementY===0?p|=l&_t:p|=i&_t,re({cursorFlags:p,mountedGroups:u}),ut(e)}function Bt(e){const{cursorFlags:t,interactionState:n,mountedGroups:r}=ne();switch(n.state){case"active":wn({document:e.currentTarget,event:e,hitRegions:n.hitRegions,initialLayoutMap:n.initialLayoutMap,mountedGroups:r,prevCursorFlags:t})}}function Gt(e){if(e.defaultPrevented)return;const{cursorFlags:t,interactionState:n,mountedGroups:r}=ne();switch(n.state){case"active":{if(e.buttons===0){re(s=>s.interactionState.state==="inactive"?s:{cursorFlags:0,interactionState:{state:"inactive"}}),re(s=>({mountedGroups:new Map(s.mountedGroups)}));return}wn({document:e.currentTarget,event:e,hitRegions:n.hitRegions,initialLayoutMap:n.initialLayoutMap,mountedGroups:r,pointerDownAtPoint:n.pointerDownAtPoint,prevCursorFlags:t});break}default:{const s=dt(e,r);s.length===0?n.state!=="inactive"&&re({interactionState:{state:"inactive"}}):re({interactionState:{hitRegions:s,state:"hover"}}),ut(e.currentTarget);break}}}function $t(e){if(e.relatedTarget instanceof HTMLIFrameElement){const{interactionState:t}=ne();switch(t.state){case"hover":re({interactionState:{state:"inactive"}})}}}function Ft(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{interactionState:t}=ne();switch(t.state){case"active":re({cursorFlags:0,interactionState:{state:"inactive"}}),t.hitRegions.length>0&&(ut(e.currentTarget),re(n=>({mountedGroups:new Map(n.mountedGroups)})),e.preventDefault())}}function Ht(e){let t=0,n=0;const r={};for(const o of e)if(o.defaultSize!==void 0){t++;const l=ce(o.defaultSize);n+=l,r[o.panelId]=l}else r[o.panelId]=void 0;const s=e.length-t;if(s!==0){const o=ce((100-n)/s);for(const l of e)l.defaultSize===void 0&&(r[l.panelId]=o)}return r}function ja(e,t,n){if(!n[0])return;const r=e.panels.find(u=>u.element===t);if(!r||!r.onResize)return;const s=De({group:e}),o=e.orientation==="horizontal"?r.element.offsetWidth:r.element.offsetHeight,l=r.mutableValues.prevSize,i={asPercentage:ce(o/s*100),inPixels:o};r.mutableValues.prevSize=i,r.onResize(i,r.id,l)}function Sa(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function Pa(e,t){const n=e.map(s=>s.id),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s))return!1;return!0}const Le=new Map;function Na(e){let t=!0;V(e.element.ownerDocument.defaultView,"Cannot register an unmounted Group");const n=e.element.ownerDocument.defaultView.ResizeObserver,r=new Set,s=new Set,o=new n(k=>{for(const f of k){const{borderBoxSize:m,target:g}=f;if(g===e.element){if(t){if(De({group:e})===0)return;re(y=>{const S=y.mountedGroups.get(e);if(S){const C=it(e),z=S.defaultLayoutDeferred?Ht(C):S.layout,T=Se({layout:z,panelConstraints:C});return!S.defaultLayoutDeferred&&je(z,T)&&Sa(S.derivedPanelConstraints,C)?y:{mountedGroups:new Map(y.mountedGroups).set(e,{defaultLayoutDeferred:!1,derivedPanelConstraints:C,layout:T,separatorToPanels:S.separatorToPanels})}}return y})}}else ja(e,g,m)}});o.observe(e.element),e.panels.forEach(k=>{V(!r.has(k.id),`Panel ids must be unique; id "${k.id}" was used more than once`),r.add(k.id),k.onResize&&o.observe(k.element)});const l=De({group:e}),i=it(e),u=e.panels.map(({id:k})=>k).join(",");let p=e.defaultLayout;p&&(Pa(e.panels,p)||(p=void 0));const d=e.inMemoryLayouts[u]??p??Ht(i),b=Se({layout:d,panelConstraints:i}),v=fn(e),j=e.element.ownerDocument;return re(k=>{const f=new Map;return Le.set(j,(Le.get(j)??0)+1),v.forEach(m=>{m.separator&&f.set(m.separator,m.panels)}),{mountedGroups:new Map(k.mountedGroups).set(e,{defaultLayoutDeferred:l===0,derivedPanelConstraints:i,layout:b,separatorToPanels:f})}}),e.separators.forEach(k=>{V(!s.has(k.id),`Separator ids must be unique; id "${k.id}" was used more than once`),s.add(k.id),k.element.addEventListener("keydown",Mt)}),Le.get(j)===1&&(j.addEventListener("dblclick",Dt,!0),j.addEventListener("pointerdown",At,!0),j.addEventListener("pointerleave",Bt),j.addEventListener("pointermove",Gt),j.addEventListener("pointerout",$t),j.addEventListener("pointerup",Ft,!0)),function(){t=!1,Le.set(j,Math.max(0,(Le.get(j)??0)-1)),re(k=>{const f=new Map(k.mountedGroups);return f.delete(e),{mountedGroups:f}}),e.separators.forEach(k=>{k.element.removeEventListener("keydown",Mt)}),Le.get(j)||(j.removeEventListener("dblclick",Dt,!0),j.removeEventListener("pointerdown",At,!0),j.removeEventListener("pointerleave",Bt),j.removeEventListener("pointermove",Gt),j.removeEventListener("pointerout",$t),j.removeEventListener("pointerup",Ft,!0)),o.disconnect()}}function za(){const[e,t]=c.useState({}),n=c.useCallback(()=>t({}),[]);return[e,n]}function ft(e){const t=c.useId();return`${e??t}`}const ze=typeof window<"u"?c.useLayoutEffect:c.useEffect;function Re(e){const t=c.useRef(e);return ze(()=>{t.current=e},[e]),c.useCallback((...n)=>t.current?.(...n),[t])}function pt(...e){return Re(t=>{e.forEach(n=>{if(n)switch(typeof n){case"function":{n(t);break}case"object":{n.current=t;break}}})})}function mt(e){const t=c.useRef({...e});return ze(()=>{for(const n in e)t.current[n]=e[n]},[e]),t.current}const kn=c.createContext(null);function Ea(e,t){const n=c.useRef({getLayout:()=>({}),setLayout:ka});c.useImperativeHandle(t,()=>n.current,[]),ze(()=>{Object.assign(n.current,hn({groupId:e}))})}function Cn({children:e,className:t,defaultLayout:n,disableCursor:r,disabled:s,elementRef:o,groupRef:l,id:i,onLayoutChange:u,onLayoutChanged:p,orientation:d="horizontal",resizeTargetMinimumSize:b={coarse:20,fine:10},style:v,...j}){const k=c.useRef({onLayoutChange:{},onLayoutChanged:{}}),f=Re(O=>{je(k.current.onLayoutChange,O)||(k.current.onLayoutChange=O,u?.(O))}),m=Re(O=>{je(k.current.onLayoutChanged,O)||(k.current.onLayoutChanged=O,p?.(O))}),g=ft(i),y=c.useRef(null),[S,C]=za(),z=c.useRef({lastExpandedPanelSizes:{},layouts:{},panels:[],resizeTargetMinimumSize:b,separators:[]}),T=pt(y,o);Ea(g,l);const E=Re((O,F)=>{const{interactionState:K,mountedGroups:P}=ne();for(const _ of P.keys())if(_.id===O){const B=P.get(_);if(B){let A=!1;switch(K.state){case"active":{A=K.hitRegions.some(X=>X.group===_);break}}return{flexGrow:B.layout[F]??1,pointerEvents:A?"none":void 0}}}return{flexGrow:n?.[F]??1}}),W=mt({defaultLayout:n,disableCursor:r}),G=c.useMemo(()=>({get disableCursor(){return!!W.disableCursor},getPanelStyles:E,id:g,orientation:d,registerPanel:O=>{const F=z.current;return F.panels=lt(d,[...F.panels,O]),C(),()=>{F.panels=F.panels.filter(K=>K!==O),C()}},registerSeparator:O=>{const F=z.current;return F.separators=lt(d,[...F.separators,O]),C(),()=>{F.separators=F.separators.filter(K=>K!==O),C()}},togglePanelDisabled:(O,F)=>{const K=z.current.panels.find(_=>_.id===O);K&&(K.panelConstraints.disabled=F);const{mountedGroups:P}=ne();for(const _ of P.keys())if(_.id===g){const B=P.get(_);B&&(B.derivedPanelConstraints=it(_))}},toggleSeparatorDisabled:(O,F)=>{const K=z.current.separators.find(P=>P.id===O);K&&(K.disabled=F)}}),[E,g,C,d,W]),U=c.useRef(null);return ze(()=>{const O=y.current;if(O===null)return;const F=z.current;let K;if(W.defaultLayout!==void 0&&Object.keys(W.defaultLayout).length===F.panels.length){K={};for(const Y of F.panels){const oe=W.defaultLayout[Y.id];oe!==void 0&&(K[Y.id]=oe)}}const P={defaultLayout:K,disableCursor:!!W.disableCursor,disabled:!!s,element:O,id:g,inMemoryLastExpandedPanelSizes:z.current.lastExpandedPanelSizes,inMemoryLayouts:z.current.layouts,orientation:d,panels:F.panels,resizeTargetMinimumSize:F.resizeTargetMinimumSize,separators:F.separators};U.current=P;const _=Na(P),B=ne().mountedGroups.get(P);if(B){const{defaultLayoutDeferred:Y,derivedPanelConstraints:oe,layout:de}=B;!Y&&oe.length>0&&(f(de),m(de))}const A=be.addListener("interactionStateChange",Y=>{Y.state}),X=be.addListener("mountedGroupsChange",Y=>{const oe=Y.get(P);if(oe){const{defaultLayoutDeferred:de,derivedPanelConstraints:ye,layout:me}=oe;if(de||ye.length===0)return;const{interactionState:Ee}=ne(),Ie=Ee.state!=="active";f(me),Ie&&m(me)}});return()=>{U.current=null,_(),A(),X()}},[s,g,m,f,d,S,W]),c.useEffect(()=>{const O=U.current;O&&(O.defaultLayout=n,O.disableCursor=!!r)}),a.jsx(kn.Provider,{value:G,children:a.jsx("div",{...j,className:t,"data-group":!0,"data-testid":g,id:g,ref:T,style:{height:"100%",width:"100%",overflow:"hidden",...v,display:"flex",flexDirection:d==="horizontal"?"row":"column",flexWrap:"nowrap",touchAction:d==="horizontal"?"pan-y":"pan-x"},children:e})})}Cn.displayName="Group";function ht(){const e=c.useContext(kn);return V(e,"Group Context not found; did you render a Panel or Separator outside of a Group?"),e}function Ia(e,t){const{id:n}=ht(),r=c.useRef({collapse:st,expand:st,getSize:()=>({asPercentage:0,inPixels:0}),isCollapsed:()=>!1,resize:st});c.useImperativeHandle(t,()=>r.current,[]),ze(()=>{Object.assign(r.current,mn({groupId:n,panelId:e}))})}function jn({children:e,className:t,collapsedSize:n="0%",collapsible:r=!1,defaultSize:s,disabled:o,elementRef:l,id:i,maxSize:u="100%",minSize:p="0%",onResize:d,panelRef:b,style:v,...j}){const k=!!i,f=ft(i),m=mt({disabled:o}),g=c.useRef(null),y=pt(g,l),{getPanelStyles:S,id:C,orientation:z,registerPanel:T,togglePanelDisabled:E}=ht(),W=d!==null,G=Re((O,F,K)=>{d?.(O,i,K)});ze(()=>{const O=g.current;if(O!==null){const F={element:O,id:f,idIsStable:k,mutableValues:{expandToSize:void 0,prevSize:void 0},onResize:W?G:void 0,panelConstraints:{collapsedSize:n,collapsible:r,defaultSize:s,disabled:m.disabled,maxSize:u,minSize:p}};return T(F)}},[n,r,s,W,f,k,u,p,G,T,m]),c.useEffect(()=>{E(f,!!o)},[o,f,E]),Ia(f,b);const U=c.useSyncExternalStore(O=>(be.addListener("mountedGroupsChange",O),()=>{be.removeListener("mountedGroupsChange",O)}),()=>JSON.stringify(S(C,f)),()=>JSON.stringify(S(C,f)));return a.jsx("div",{...j,"aria-disabled":o||void 0,"data-panel":!0,"data-testid":f,id:f,ref:y,style:{...La,display:"flex",flexBasis:0,flexShrink:1,overflow:"hidden",...JSON.parse(U)},children:a.jsx("div",{className:t,style:{maxHeight:"100%",maxWidth:"100%",flexGrow:1,...v,touchAction:z==="horizontal"?"pan-y":"pan-x"},children:e})})}jn.displayName="Panel";const La={minHeight:0,maxHeight:"100%",height:"auto",minWidth:0,maxWidth:"100%",width:"auto",border:"none",borderWidth:0,padding:0,margin:0};function Ta({layout:e,panelConstraints:t,panelId:n,panelIndex:r}){let s,o;const l=e[n],i=t.find(u=>u.panelId===n);if(i){const u=i.maxSize,p=i.collapsible?i.collapsedSize:i.minSize,d=[r,r+1];o=Se({layout:_e({delta:p-l,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:e}),panelConstraints:t})[n],s=Se({layout:_e({delta:u-l,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:e}),panelConstraints:t})[n]}return{valueControls:n,valueMax:s,valueMin:o,valueNow:l}}function Sn({children:e,className:t,disabled:n,elementRef:r,id:s,style:o,...l}){const i=ft(s),u=mt({disabled:n}),[p,d]=c.useState({}),[b,v]=c.useState("inactive"),j=c.useRef(null),k=pt(j,r),{disableCursor:f,id:m,orientation:g,registerSeparator:y,toggleSeparatorDisabled:S}=ht(),C=g==="horizontal"?"vertical":"horizontal";ze(()=>{const T=j.current;if(T!==null){const E={disabled:u.disabled,element:T,id:i},W=y(E),G=be.addListener("interactionStateChange",O=>{v(O.state!=="inactive"&&O.hitRegions.some(F=>F.separator===E)?O.state:"inactive")}),U=be.addListener("mountedGroupsChange",O=>{O.forEach(({derivedPanelConstraints:F,layout:K,separatorToPanels:P},_)=>{if(_.id===m){const B=P.get(E);if(B){const A=B[0],X=_.panels.indexOf(A);d(Ta({layout:K,panelConstraints:F,panelId:A.id,panelIndex:X}))}}})});return()=>{G(),U(),W()}}},[m,i,y,u]),c.useEffect(()=>{S(i,!!n)},[n,i,S]);let z;return n&&!f&&(z="not-allowed"),a.jsx("div",{...l,"aria-controls":p.valueControls,"aria-disabled":n||void 0,"aria-orientation":C,"aria-valuemax":p.valueMax,"aria-valuemin":p.valueMin,"aria-valuenow":p.valueNow,children:e,className:t,"data-separator":n?"disabled":b,"data-testid":i,id:i,ref:k,role:"separator",style:{flexBasis:"auto",cursor:z,...o,flexGrow:0,flexShrink:0,touchAction:"none"},tabIndex:n?void 0:0})}Sn.displayName="Separator";const Da={top:"Split Top",bottom:"Split Bottom",left:"Split Left",right:"Split Right",center:"Swap"};function hs({position:e}){const t=Ma(e);return a.jsxs("div",{className:"absolute inset-0 z-40 pointer-events-none",children:[a.jsx("div",{className:M("absolute transition-all duration-100 rounded-md","bg-accent-blue/20 border-2 border-dashed border-accent-blue/60"),style:t}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("span",{className:M("text-xs font-medium px-2.5 py-1 rounded-md","bg-accent-blue/90 text-white shadow-lg","backdrop-blur-sm"),children:Da[e]})})]})}function Ma(e){switch(e){case"top":return{top:0,left:0,right:0,height:"50%"};case"bottom":return{bottom:0,left:0,right:0,height:"50%"};case"left":return{top:0,bottom:0,left:0,width:"50%"};case"right":return{top:0,bottom:0,right:0,width:"50%"};case"center":return{top:0,bottom:0,left:0,right:0}}}function Kt(e,t,n){const r=(e-n.left)/n.width,s=(t-n.top)/n.height,o=.25;return s<o?"top":s>1-o?"bottom":r<o?"left":r>1-o?"right":"center"}const Pn=()=>Pe(()=>import("./SimpleTerminalPane-Brvwg3Wo.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(e=>({default:e.SimpleTerminalPane})),Aa=c.lazy(Pn);Pn();const Ra=c.lazy(()=>Pe(()=>import("./EditorPane-ClvhC1ZG.js"),__vite__mapDeps([10,1,5,2,6,7,4,11,12,13,14,15,16,17])).then(e=>({default:e.EditorPane}))),Nn=()=>`pane-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;function zn({label:e}){return a.jsx("div",{className:"h-full w-full flex items-center justify-center bg-background",children:a.jsx("div",{className:"text-xs text-text-muted",children:e})})}function En(e){const t=100/e;return Array(e).fill(t)}function Me(e){if(e.length===0)return[];const t=e.map(r=>Number.isFinite(r)&&r>0?r:0),n=t.reduce((r,s)=>r+s,0);return n<=0?En(e.length):t.map(r=>r/n*100)}function Oe(e){return e.sizes&&e.sizes.length===e.children.length?Me(e.sizes):En(e.children.length)}function ge(e,t){if(!e)return null;if(e.id===t)return e;if(e.type==="split")for(const n of e.children){const r=ge(n,t);if(r)return r}return null}function ve(e){return e?e.type==="terminal"||e.type==="editor"?[e.id]:e.children.flatMap(t=>ve(t)):[]}function In(e){return e?e.type==="terminal"?[e]:e.type==="editor"?[]:e.children.flatMap(t=>In(t)):[]}function Xe(e,t){if(e.type==="terminal"||e.type==="editor")return e.id===t?null:e;const n=[],r=[];let s=!1;for(let i=0;i<e.children.length;i++){const u=e.children[i],p=Xe(u,t);p?(n.push(p),r.push(i),p!==u&&(s=!0)):s=!0}if(!s)return e;if(n.length===0)return null;if(n.length===1)return n[0];const o=Oe(e),l=Me(r.map(i=>o[i]??0));return{...e,children:n,sizes:l}}function Ue(e,t,n,r){if((e.type==="terminal"||e.type==="editor")&&e.id===t)return{type:"split",id:Nn(),direction:n,children:[e,r],sizes:[50,50]};if(e.type==="terminal"||e.type==="editor")return e;const s=e.children.findIndex(i=>i.id===t);if(s!==-1&&e.direction===n){const i=[...e.children];i.splice(s+1,0,r);const u=Oe(e),p=u[s]??100/e.children.length,d=p/2,b=p-d,v=[...u];return v[s]=d,v.splice(s+1,0,b),{...e,children:i,sizes:Me(v)}}let o=!1;const l=e.children.map(i=>{const u=Ue(i,t,n,r);return u!==i&&(o=!0),u});return o?{...e,children:l}:e}function _a(e,t,n){const r=ge(e,t),s=ge(e,n);if(!r||!s)return e;function o(l){return l.type==="terminal"||l.type==="editor"?l.id===t?{...s}:l.id===n?{...r}:l:{...l,children:l.children.map(i=>o(i))}}return o(e)}function Oa(e,t,n,r){if(t===n)return e;const s=ge(e,t);if(!s||s.type==="split")return e;const o=s,l=Xe(e,t);if(!l)return e;const i=r==="top"||r==="bottom"?"vertical":"horizontal",u=r==="top"||r==="left";function p(d){if((d.type==="terminal"||d.type==="editor")&&d.id===n)return{type:"split",id:Nn(),direction:i,children:u?[o,d]:[d,o],sizes:[50,50]};if(d.type==="terminal"||d.type==="editor")return d;const b=d.children.findIndex(k=>k.id===n);if(b!==-1&&d.direction===i){const k=[...d.children],f=u?b:b+1;k.splice(f,0,o);const m=Oe(d),g=m[b]??100/d.children.length,y=g/2,S=g-y,C=[...m];return u?(C.splice(b,0,S),C[b+1]=y):(C[b]=y,C.splice(b+1,0,S)),{...d,children:k,sizes:Me(C)}}let v=!1;const j=d.children.map(k=>{const f=p(k);return f!==k&&(v=!0),f});return v?{...d,children:j}:d}return p(l)}function Ln(e,t,n){if(e.type!=="split")return e;if(e.id===t){const o=Oe(e),l=Me(e.children.map((u,p)=>n[p]??o[p]??0));return l.length!==o.length||l.some((u,p)=>Math.abs(u-o[p])>.2)?{...e,sizes:l}:e}let r=!1;const s=e.children.map(o=>{const l=Ln(o,t,n);return l!==o&&(r=!0),l});return r?{...e,children:s}:e}const Wa=c.memo(function({direction:t}){const n=t==="horizontal";return a.jsx(Sn,{className:M("bm-resize-handle","bg-border hover:bg-accent-blue transition-colors duration-150",n?"w-px cursor-col-resize":"h-px cursor-row-resize")})}),Ba=c.memo(function({pane:t,workspaceId:n,isActive:r,isVisible:s,onFocus:o,onClose:l,onSplit:i,onPaneDragStart:u,onPaneDragEnd:p,isDragTarget:d,dragPosition:b}){return a.jsx("div",{className:"h-full w-full",children:a.jsx(c.Suspense,{fallback:a.jsx(zn,{label:"Loading terminal..."}),children:a.jsx(Aa,{session:t.session,paneId:t.id,workspaceId:n,isActive:r,isVisible:s,onClose:l,onFocus:o,onSplit:i,onPaneDragStart:u,onPaneDragEnd:p,isDragTarget:d,dragPosition:b})})})}),Vt=c.memo(function({paneId:t,draggedPaneId:n,onDragOver:r,onDragLeave:s,onDrop:o,dropTarget:l,children:i}){const u=c.useRef(null),p=c.useCallback(v=>{if(!v.dataTransfer.types.includes("application/x-bridgespace-pane")||n===t)return;v.preventDefault(),v.dataTransfer.dropEffect="move";const j=u.current?.getBoundingClientRect();if(j){const k=Kt(v.clientX,v.clientY,j);r(t,k)}},[t,n,r]),d=c.useCallback(v=>{u.current&&!u.current.contains(v.relatedTarget)&&s(t)},[t,s]),b=c.useCallback(v=>{if(!v.dataTransfer.types.includes("application/x-bridgespace-pane"))return;v.preventDefault(),v.stopPropagation();const j=u.current?.getBoundingClientRect();if(j){const k=Kt(v.clientX,v.clientY,j);o(t,k)}},[t,o]);return l?.paneId,a.jsxs("div",{ref:u,className:"h-full w-full relative",onDragOver:p,onDragLeave:d,onDrop:b,children:[i,n===t&&a.jsx("div",{className:"absolute inset-0 z-30 bg-black/30 pointer-events-none"})]})}),Ut=c.memo(function({node:t,workspaceId:n,activePaneId:r,isVisible:s,onFocusPane:o,onClosePane:l,onSplitPane:i,draggedPaneId:u,onPaneDragStart:p,onPaneDragEnd:d,onPaneDragOver:b,onPaneDragLeave:v,onPaneDrop:j,dropTarget:k}){const f=t.id,m=c.useCallback(()=>o(f),[o,f]),g=c.useCallback(()=>l(f),[l,f]),y=c.useCallback(C=>i(f,C),[i,f]),S=k?.paneId===f&&u!==f;return t.type==="terminal"?a.jsx(Vt,{paneId:f,draggedPaneId:u,onDragOver:b,onDragLeave:v,onDrop:j,dropTarget:k,children:a.jsx(Ba,{pane:t,workspaceId:n,isActive:r===f,isVisible:s,onFocus:m,onClose:g,onSplit:y,onPaneDragStart:p,onPaneDragEnd:d,isDragTarget:S,dragPosition:S?k?.position??null:null})}):a.jsx(Vt,{paneId:f,draggedPaneId:u,onDragOver:b,onDragLeave:v,onDrop:j,dropTarget:k,children:a.jsx(c.Suspense,{fallback:a.jsx(zn,{label:"Loading editor..."}),children:a.jsx(Ra,{pane:t,isActive:r===f,onFocus:m,onClose:g,onSplit:y,onPaneDragStart:p,onPaneDragEnd:d,isDragTarget:S,dragPosition:S?k?.position??null:null})})})}),Ga=c.memo(function e({node:t,workspaceId:n,activePaneId:r,isVisible:s,onFocusPane:o,onClosePane:l,onSplitPane:i,draggedPaneId:u,onPaneDragStart:p,onPaneDragEnd:d,onPaneDragOver:b,onPaneDragLeave:v,onPaneDrop:j,dropTarget:k,onPaneLayoutChange:f}){if(t.type==="terminal")return a.jsx(Ut,{node:t,workspaceId:n,activePaneId:r,isVisible:s,onFocusPane:o,onClosePane:l,onSplitPane:i,draggedPaneId:u,onPaneDragStart:p,onPaneDragEnd:d,onPaneDragOver:b,onPaneDragLeave:v,onPaneDrop:j,dropTarget:k});if(t.type==="editor")return a.jsx(Ut,{node:t,workspaceId:n,activePaneId:r,isVisible:s,onFocusPane:o,onClosePane:l,onSplitPane:i,draggedPaneId:u,onPaneDragStart:p,onPaneDragEnd:d,onPaneDragOver:b,onPaneDragLeave:v,onPaneDrop:j,dropTarget:k});const m=Oe(t),g=t.children.reduce((T,E,W)=>(T[E.id]=m[W]??0,T),{}),y=`${t.id}:${t.children.map(T=>T.id).join("|")}`,S=c.useRef(t);S.current=t;const C=c.useRef(m);C.current=m;const z=c.useCallback(T=>{if(!f)return;const E=S.current,W=C.current,G=E.children.map((U,O)=>T[U.id]??W[O]??0);f(E.id,Me(G))},[f]);return a.jsx(Cn,{orientation:t.direction,className:"h-full",defaultLayout:g,onLayoutChange:z,children:t.children.map((T,E)=>a.jsxs(c.Fragment,{children:[a.jsx(jn,{id:T.id,defaultSize:m[E],minSize:10,children:a.jsx("div",{className:"h-full w-full min-w-0",children:a.jsx(e,{node:T,workspaceId:n,activePaneId:r,isVisible:s,onFocusPane:o,onClosePane:l,onSplitPane:i,draggedPaneId:u,onPaneDragStart:p,onPaneDragEnd:d,onPaneDragOver:b,onPaneDragLeave:v,onPaneDrop:j,dropTarget:k,onPaneLayoutChange:f})})}),E<t.children.length-1&&a.jsx(Wa,{direction:t.direction})]},T.id))},y)});function $a({onCreate:e}){return a.jsx("div",{className:"h-full w-full flex items-center justify-center bg-background",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl bg-surface flex items-center justify-center border border-border/50",children:a.jsx(ct,{size:24,className:"text-text-muted"})}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("h3",{className:"text-sm font-medium text-text-primary",children:"No terminals open"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Press ⌘N to create a new terminal"})]}),a.jsx("button",{onClick:e,className:M("px-4 py-2 rounded-lg text-sm font-medium","bg-accent-blue text-white","hover:bg-accent-blue/90 transition-colors","shadow-lg shadow-accent-blue/20"),children:"New Terminal"})]})})}function Fa(){return a.jsx("div",{className:"h-full w-full flex items-center justify-center bg-background",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-10 h-10 border-2 border-accent-blue/20 rounded-full"}),a.jsx("div",{className:"absolute inset-0 w-10 h-10 border-2 border-accent-blue border-t-transparent rounded-full animate-spin"})]}),a.jsx("span",{className:"text-sm text-text-secondary",children:"Initializing workspace..."})]})})}const Ha=c.memo(function({workspaceId:t,layout:n,activePaneId:r,isVisible:s=!0,onFocusPane:o,onClosePane:l,onSplitPane:i,onCreatePane:u,onDragStateChange:p,onPaneReorder:d,onPaneLayoutChange:b,isLoading:v}){const[j,k]=c.useState(null),[f,m]=c.useState(null),g=c.useCallback(T=>{p?Zt.flushSync(()=>{k(T),p(!0)}):k(T)},[p]),y=c.useCallback(()=>{k(null),m(null),p?.(!1)},[p]),S=c.useCallback((T,E)=>{m(W=>W?.paneId===T&&W?.position===E?W:{paneId:T,position:E})},[]),C=c.useCallback(T=>{m(E=>E?.paneId===T?null:E)},[]),z=c.useCallback((T,E)=>{j&&j!==T&&d?.(j,T,E),k(null),m(null),p?.(!1)},[j,d,p]);return v?a.jsx(Fa,{}):n?a.jsx("div",{className:"h-full bg-background relative",children:a.jsx(Ga,{node:n,workspaceId:t,activePaneId:r,isVisible:s,onFocusPane:o,onClosePane:l,onSplitPane:i,draggedPaneId:j,onPaneDragStart:g,onPaneDragEnd:y,onPaneDragOver:S,onPaneDragLeave:C,onPaneDrop:z,dropTarget:f,onPaneLayoutChange:b})}):a.jsx($a,{onCreate:u||(()=>{})})});function Ka({isOpen:e,version:t,isDownloading:n,isDownloaded:r,downloadPercent:s,onInstall:o,onDismiss:l}){return e?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:l}),a.jsxs("div",{className:"relative z-10 w-full max-w-sm rounded-lg border border-border bg-surface shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md border border-accent-blue/30 bg-accent-blue/10 text-accent-blue",children:a.jsx(kt,{size:15})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold text-text-primary",children:"Update Available"}),a.jsxs("p",{className:"text-[11px] text-text-muted",children:["BridgeSpace v",t]})]})]}),a.jsx("button",{onClick:l,className:"rounded-md p-1 text-text-muted transition-colors hover:bg-surface-hover hover:text-text-primary",children:a.jsx(Ne,{size:14})})]}),a.jsxs("div",{className:"px-4 py-4",children:[a.jsxs("p",{className:"text-xs text-text-secondary",children:["A new version of BridgeSpace is available.",r?" The update has been downloaded and is ready to install.":n?" Downloading the update...":" Would you like to update now?"]}),n&&!r&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{className:"mb-1 flex items-center justify-between text-[10px] text-text-muted",children:[a.jsx("span",{children:"Downloading..."}),a.jsxs("span",{children:[s,"%"]})]}),a.jsx("div",{className:"h-1.5 w-full overflow-hidden rounded-full bg-surface-hover",children:a.jsx("div",{className:"h-full rounded-full bg-accent-blue transition-all duration-300",style:{width:`${s}%`}})})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-border px-4 py-3",children:[a.jsx("button",{onClick:l,className:M("rounded-md border border-border bg-surface-hover px-3 py-1.5","text-xs font-medium text-text-secondary transition-colors hover:text-text-primary hover:border-border-active"),children:"Later"}),a.jsx("button",{onClick:o,disabled:n&&!r,className:M("inline-flex items-center gap-2 rounded-md border border-accent-blue bg-accent-blue px-3 py-1.5","text-xs font-semibold text-white transition-colors hover:bg-accent-blue/90","disabled:cursor-not-allowed disabled:opacity-60"),children:n&&!r?a.jsxs(a.Fragment,{children:[a.jsx(mr,{size:13,className:"animate-spin"}),"Downloading..."]}):a.jsxs(a.Fragment,{children:[a.jsx(kt,{size:13}),r?"Install and Restart":"Update Now"]})})]})]})]}):null}function Va(){const[e,t]=c.useState(!1),[n,r]=c.useState(""),[s,o]=c.useState(!1),[l,i]=c.useState(!1),[u,p]=c.useState(0);c.useEffect(()=>{const v=window.tauriAPI?.updater;if(!v)return;const j=v.onUpdateAvailable(({version:g})=>{r(g),o(!0),i(!1),p(0),t(!0)}),k=v.onDownloadProgress(({percent:g})=>{p(g)}),f=v.onUpdateDownloaded(({version:g})=>{r(g),o(!1),i(!0),p(100),t(!0)}),m=v.onError(()=>{o(!1)});return()=>{j(),k(),f(),m()}},[]);const d=c.useCallback(async()=>{try{await window.tauriAPI?.updater?.quitAndInstall()}catch{}},[]),b=c.useCallback(()=>{t(!1)},[]);return{isOpen:e,version:n,isDownloading:s,isDownloaded:l,downloadPercent:u,handleInstall:d,handleDismiss:b}}const Xt=["void","ghost","plasma","carbon","hex","neon-tokyo","obsidian","nebula","storm","infrared","nova","stealth","hologram","dracula","bridgemind","paper","chalk","solar","arctic","ivory"],Ua=["paper","chalk","solar","arctic","ivory"],Tn=c.createContext(void 0);function Xa({children:e}){const[t,n]=c.useState(()=>{const s=localStorage.getItem("bridgemind-theme");return Xt.includes(s)?s:"void"});c.useEffect(()=>{localStorage.setItem("bridgemind-theme",t),Xt.forEach(s=>document.documentElement.classList.remove(`theme-${s}`)),document.documentElement.classList.add(`theme-${t}`),document.documentElement.style.colorScheme=Ua.includes(t)?"light":"dark"},[t]);const r=c.useMemo(()=>({theme:t,setTheme:n}),[t]);return a.jsx(Tn.Provider,{value:r,children:e})}function xs(){const e=c.useContext(Tn);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e}const He=500,qt=5e5;function qa(e,t){switch(t.type){case"ADD_BLOCK":{const{terminalId:n,block:r}=t.payload,s=e.blocks[n]||[],o=s.length>=He?[...s.slice(-He+1),r]:[...s,r];return{...e,blocks:{...e.blocks,[n]:o}}}case"UPDATE_PENDING":{const{terminalId:n,block:r}=t.payload;return{...e,pendingBlocks:{...e.pendingBlocks,[n]:r}}}case"APPEND_OUTPUT":{const{terminalId:n,output:r}=t.payload,s=e.pendingBlocks[n];if(!s)return e;const o=s.output||"",l=o.length+r.length>qt?o.slice(-(qt-r.length))+r:o+r;return{...e,pendingBlocks:{...e.pendingBlocks,[n]:{...s,output:l}}}}case"COMPLETE_PENDING":{const{terminalId:n,exitCode:r}=t.payload,s=e.pendingBlocks[n];if(!s||!s.id)return e;const o=s.command||"";if(!o.trim())return{...e,pendingBlocks:{...e.pendingBlocks,[n]:null}};const l={id:s.id,terminalId:n,command:o,output:s.output||"",exitCode:r,startTime:s.startTime||Date.now(),endTime:Date.now(),state:"complete",isCollapsed:!1,cwd:s.cwd,gitBranch:s.gitBranch},i=e.blocks[n]||[],u=i.length>=He?[...i.slice(-He+1),l]:[...i,l];return{...e,blocks:{...e.blocks,[n]:u},pendingBlocks:{...e.pendingBlocks,[n]:null}}}case"TOGGLE_COLLAPSE":{const{terminalId:n,blockId:r}=t.payload,s=e.blocks[n];return s?{...e,blocks:{...e.blocks,[n]:s.map(o=>o.id===r?{...o,isCollapsed:!o.isCollapsed}:o)}}:e}case"COLLAPSE_ALL":{const{terminalId:n}=t.payload,r=e.blocks[n];return r?{...e,blocks:{...e.blocks,[n]:r.map(s=>({...s,isCollapsed:!0}))}}:e}case"EXPAND_ALL":{const{terminalId:n}=t.payload,r=e.blocks[n];return r?{...e,blocks:{...e.blocks,[n]:r.map(s=>({...s,isCollapsed:!1}))}}:e}case"CLEAR_BLOCKS":{const{terminalId:n}=t.payload;return{...e,blocks:{...e.blocks,[n]:[]},pendingBlocks:{...e.pendingBlocks,[n]:null}}}case"SET_SHELL_INTEGRATION":{const{terminalId:n,active:r}=t.payload;return{...e,shellIntegration:{...e.shellIntegration,[n]:r}}}case"REMOVE_TERMINAL":{const{terminalId:n}=t.payload,{[n]:r,...s}=e.blocks,{[n]:o,...l}=e.pendingBlocks,{[n]:i,...u}=e.shellIntegration;return{blocks:s,pendingBlocks:l,shellIntegration:u}}default:return e}}function Ya(){let e={blocks:{},pendingBlocks:{},shellIntegration:{}};const t=new Set;function n(){return e}function r(o){const l=e;e=qa(e,o),e!==l&&t.forEach(i=>i())}function s(o){return t.add(o),()=>{t.delete(o)}}return{getState:n,dispatch:r,subscribe:s}}const Ja=c.createContext(null);function Qa({children:e}){const t=c.useRef(null);t.current||(t.current=Ya());const n=t.current,r=c.useMemo(()=>({addBlock:(o,l)=>n.dispatch({type:"ADD_BLOCK",payload:{terminalId:o,block:l}}),updatePending:(o,l)=>n.dispatch({type:"UPDATE_PENDING",payload:{terminalId:o,block:l}}),appendOutput:(o,l)=>n.dispatch({type:"APPEND_OUTPUT",payload:{terminalId:o,output:l}}),completePending:(o,l)=>n.dispatch({type:"COMPLETE_PENDING",payload:{terminalId:o,exitCode:l}}),toggleCollapse:(o,l)=>n.dispatch({type:"TOGGLE_COLLAPSE",payload:{terminalId:o,blockId:l}}),collapseAll:o=>n.dispatch({type:"COLLAPSE_ALL",payload:{terminalId:o}}),expandAll:o=>n.dispatch({type:"EXPAND_ALL",payload:{terminalId:o}}),clearBlocks:o=>n.dispatch({type:"CLEAR_BLOCKS",payload:{terminalId:o}}),setShellIntegration:(o,l)=>n.dispatch({type:"SET_SHELL_INTEGRATION",payload:{terminalId:o,active:l}}),removeTerminal:o=>n.dispatch({type:"REMOVE_TERMINAL",payload:{terminalId:o}}),startBlock:(o,l)=>{const i=`block_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;return n.dispatch({type:"UPDATE_PENDING",payload:{terminalId:o,block:{id:i,terminalId:o,command:"",output:"",exitCode:null,startTime:Date.now(),endTime:null,state:"prompting",isCollapsed:!1,cwd:l?.cwd,gitBranch:l?.gitBranch}}}),i}}),[n]),s=c.useMemo(()=>({store:n,actions:r}),[n,r]);return a.jsx(Ja.Provider,{value:s,children:e})}const Za=pe.lazy(()=>Pe(()=>import("./WelcomeScreen-BqxlFsnG.js"),__vite__mapDeps([18,1,5,2,6,7,13,11,19,15])).then(e=>({default:e.WelcomeScreen}))),es=pe.lazy(()=>Pe(()=>import("./KanbanBoard-BHpy45A2.js"),__vite__mapDeps([20,1,5,2,6,7,21,14,8,15,17,22,16])).then(e=>({default:e.KanbanBoard}))),ts=pe.lazy(()=>Pe(()=>import("./AgentsPage-CWJgCA9f.js"),__vite__mapDeps([23,1,5,2,6,7,21,24,22,14,16,12])).then(e=>({default:e.AgentsPage}))),ns=pe.lazy(()=>Pe(()=>import("./PromptsPage-DeL-hXx5.js"),__vite__mapDeps([25,1,5,2,6,7,21,24,14,26,12])).then(e=>({default:e.PromptsPage}))),rs=pe.lazy(()=>Pe(()=>import("./SettingsPage-C7gyz6SV.js"),__vite__mapDeps([27,1,5,2,6,7,19,26,14,12,13])).then(e=>({default:e.SettingsPage}))),le=()=>`pane-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Dn="bridgespace-project-paths";function Mn(){try{const e=localStorage.getItem(Dn);return e?JSON.parse(e):{}}catch{return{}}}function Yt(e,t){const n=Mn();n[e]=t,localStorage.setItem(Dn,JSON.stringify(n))}function as(e){return Mn()[e]||null}function ss(e){if(!e)return;In(e).forEach(n=>{window.tauriAPI?.terminal?.destroy(n.session.id)})}function os({onDrop:e,activeWorkspaceId:t}){const[n,r]=c.useState(!1),s=c.useCallback(i=>{i.dataTransfer.types.includes("application/x-bridgespace-pane")&&(i.preventDefault(),i.stopPropagation(),i.dataTransfer.dropEffect="move",r(!0))},[]),o=c.useCallback(i=>{i.currentTarget.contains(i.relatedTarget)||r(!1)},[]),l=c.useCallback(i=>{if(i.dataTransfer.types.includes("application/x-bridgespace-pane")){i.preventDefault(),i.stopPropagation(),r(!1);try{const u=i.dataTransfer.getData("application/x-bridgespace-pane");if(!u)return;const p=JSON.parse(u),d=p.workspaceId||t;d&&e(p,d)}catch{}}},[e,t]);return a.jsx("div",{className:"fixed top-0 left-0 right-0 z-[9999] no-drag-region",style:{height:44},onDragOver:s,onDragLeave:o,onDrop:l,children:a.jsx("div",{className:`h-full flex items-center justify-center transition-all duration-150 ${n?"bg-[var(--accent-blue)]/25 ring-2 ring-inset ring-[var(--accent-blue)]":"bg-[var(--accent-blue)]/10"}`,children:a.jsx("span",{className:`text-sm font-medium px-3 py-1.5 rounded-lg shadow-lg transition-all duration-150 ${n?"bg-[var(--accent-blue)] text-white scale-105":"bg-[var(--accent-blue)]/80 text-white scale-100"}`,children:"Drop here to create new workspace"})})})}const is=pe.memo(function({workspace:t,isActive:n,onFocusPane:r,onClosePane:s,onSplitPane:o,onCreatePane:l,onDragStateChange:i,onPaneReorder:u,onPaneLayoutChange:p}){const d=t.id,b=c.useCallback(m=>r(d,m),[r,d]),v=c.useCallback(m=>s(d,m),[s,d]),j=c.useCallback((m,g)=>o(d,m,g),[o,d]),k=c.useCallback((m,g,y)=>u(d,m,g,y),[u,d]),f=c.useCallback((m,g)=>p(d,m,g),[p,d]);return a.jsx("div",{className:`absolute inset-0 ${n?"":"invisible pointer-events-none"}`,"aria-hidden":!n,children:a.jsx(Ha,{workspaceId:d,layout:t.layout,activePaneId:t.activePaneId,isVisible:n,onFocusPane:b,onClosePane:v,onSplitPane:j,onCreatePane:l,onDragStateChange:i,onPaneReorder:k,onPaneLayoutChange:f})})}),ls=new Set(["kanban","agents","prompts"]),cs={kanban:"Kanban Board",agents:"Agents",prompts:"Prompts Library"};function ds(){const[e,t]=c.useState(new Map),[n,r]=c.useState(null),s=c.useRef(!1),[o,l]=c.useState("terminal");c.useEffect(()=>{l("terminal")},[]);const i=Va(),{requirePro:u}=Qt(),p=c.useCallback(x=>{if(x==="settings"&&o==="settings"){l("terminal");return}l(x)},[u,o]),[d,b]=c.useState(null),[v,j]=c.useState(!1),k=c.useRef([]),[f,m]=c.useState(!1),[g,y]=c.useState(null),[S,C]=c.useState(!1),[z,T]=c.useState(!1),E=c.useMemo(()=>n&&e.get(n)||null,[e,n]),W=c.useMemo(()=>Array.from(e.values()).map(x=>({id:x.id,label:x.name,path:x.rootPath,isActive:x.id===n,terminalCount:ve(x.layout).length,color:x.color})),[e,n]),[G,U]=c.useState(0),O=c.useRef(!1),F=c.useCallback(async x=>{try{const w=x||await window.tauriAPI?.system?.getHomeDir()||"~";b({cwd:w,tabIndex:G}),j(!0)}catch{}},[G]),K=c.useCallback(async x=>{try{const w=x||await window.tauriAPI?.system?.getHomeDir()||"~";b({cwd:w,tabIndex:G}),m(!0)}catch{}},[G]),P=c.useCallback((x,w,N)=>{if(d&&(b({...d,templateId:x,cwd:w,agents:N}),m(!1),j(!0),window.tauriAPI?.terminal)){const L=ot(x)?.terminalCount??1;if(L>1){const D=Array(L).fill(null).map(()=>window.tauriAPI.terminal.create(w).catch(()=>null));Promise.allSettled(D).then(I=>{k.current=I.filter(R=>R.status==="fulfilled"&&R.value!==null).map(R=>R.value)})}}},[d]),_=c.useCallback(async(x,w)=>{if(!d)return null;try{if(!window.tauriAPI?.terminal)return null;const{cwd:N,templateId:h,agents:L}=d,I=(h?ot(h):null)?.terminalCount??1,R=Q=>{if(!L||L.length===0||Q.length===0)return;const ie=L.filter(Z=>Z.enabled&&Z.count>0);if(ie.length===0)return;const xe=[];for(const Z of ie)for(let Ae=0;Ae<Z.count;Ae++)xe.push(Z.command);if(xe.length===0)return;const we=(Z,Ae)=>{let ee=!1,nt=!1;const yt=()=>{nt||(nt=!0,window.tauriAPI.terminal.write(Z,Ae+`
`))},vt=window.tauriAPI.terminal.onData(wt=>{wt.id===Z&&!ee&&wt.data.includes("\x1B]133;A")&&(ee=!0,setTimeout(()=>{yt(),vt()},50))});setTimeout(()=>{nt||(yt(),vt())},500)},ke=Math.min(xe.length,Q.length);for(let Z=0;Z<ke;Z++)we(Q[Z].id,xe[Z])},$=k.current;k.current=[];const H=$.length>=I&&$.every(Q=>Q&&Q.id);let J,he=[];if(H)[J,...he]=$.slice(0,I);else{for(const Q of $)Q?.id&&window.tauriAPI.terminal.destroy(Q.id);if(J=await window.tauriAPI.terminal.create(N),!J||!J.id)return null}const ae=le(),tt=le(),Un={id:ae,name:w,rootPath:N,layout:{type:"terminal",id:tt,session:J},activePaneId:tt,color:x};return r(ae),l("terminal"),t(Q=>new Map(Q).set(ae,Un)),U(Q=>Q+1),b(null),I<=1?(R([J]),ae):((async()=>{let Q;if(H)Q=$.slice(0,I);else{const ie=I-1-he.length,xe=[...he];if(ie>0){const we=Array(ie).fill(null).map(()=>window.tauriAPI.terminal.create(N)),ke=await Promise.allSettled(we),Z=ke.filter(ee=>ee.status==="fulfilled").map(ee=>ee.value).filter(ee=>ee!==null&&!!ee.id);ke.filter(ee=>ee.status==="rejected").map(ee=>ee.reason instanceof Error?`${ee.reason.name}: ${ee.reason.message}`:String(ee.reason)).length>0,xe.push(...Z)}Q=[J,...xe]}if(Q.length<I,h&&Q.length>1){const ie=Tr(h,Q);if(ie){const xe=ie.type==="terminal"?ie.id:ve(ie)[0]||tt;t(we=>{const ke=we.get(ae);if(!ke)return we;const Z=new Map(we);return Z.set(ae,{...ke,layout:ie,activePaneId:xe}),Z})}}R(Q)})(),ae)}catch{return null}},[d]),B=c.useCallback(async x=>{try{if(!window.tauriAPI?.terminal)return null;const w=await window.tauriAPI.terminal.create(x);if(!w||!w.id)return null;const N=le(),h=le(),D=at(G);let I=x;try{const H=await window.tauriAPI?.fs?.basename(x);H&&(I=H)}catch{I=x.split(/[\\/]/).filter(Boolean).pop()||x}const $={id:h,name:I,rootPath:x,layout:{type:"terminal",id:N,session:w},activePaneId:N,color:D};return r(h),l("terminal"),t(H=>new Map(H).set(h,$)),U(H=>H+1),{workspaceId:h,sessionId:w.id,shell:w.shell}}catch{return null}},[G]),A=c.useCallback(async x=>(F(x),null),[F]),X=c.useCallback((x,w)=>{const N=e.get(x);if(!N?.layout)return null;const h=ge(N.layout,w);if(!h||h.type!=="terminal")return null;const L=h.session,I=ve(N.layout).filter(R=>R!==w);return I.length===0?t(R=>{const $=new Map(R);return $.delete(x),$}):t(R=>{const $=R.get(x);if(!$||!$.layout)return R;const H=Xe($.layout,w),J=new Map(R);return J.set(x,{...$,layout:H,activePaneId:$.activePaneId===w?I[I.length-1]||null:$.activePaneId}),J}),L},[e]),Y=c.useCallback(x=>{const w=le(),N=le(),h=G,L=at(h),D=Nt(h),I={type:"terminal",id:w,session:x},R={id:N,name:D,rootPath:x.cwd,layout:I,activePaneId:w,color:L};return r(N),l("terminal"),t($=>new Map($).set(N,R)),U($=>$+1),N},[G]),oe=c.useCallback((x,w)=>{const N=X(w,x.paneId);if(!N){C(!1);return}Y(N),C(!1)},[X,Y]),de=c.useCallback((x,w,N,h)=>{t(L=>{const D=L.get(x);if(!D?.layout)return L;let I;if(h==="center"?I=_a(D.layout,w,N):I=Oa(D.layout,w,N,h),!I)return L;const R=new Map(L);return R.set(x,{...D,layout:I}),R})},[]),ye=c.useCallback((x,w,N)=>{t(h=>{const L=h.get(x);if(!L?.layout)return h;const D=ge(L.layout,w);if(!D||D.type!=="split")return h;const I=D.sizes;if(I&&I.length===N.length&&I.every((H,J)=>Math.abs(H-N[J])<=.2))return h;const R=Ln(L.layout,w,N);if(R===L.layout)return h;const $=new Map(h);return $.set(x,{...L,layout:R}),$})},[]),me=c.useCallback(x=>{const w=e.get(x);if(w&&ss(w.layout),t(N=>{const h=new Map(N);return h.delete(x),h}),n===x){const N=Array.from(e.keys()).filter(h=>h!==x);r(N[N.length-1]||null)}},[e,n]),Ee=c.useCallback(x=>{e.has(x)&&(r(x),l("terminal"))},[e]),Ie=c.useCallback(x=>{n&&t(w=>{const N=w.get(n);if(!N)return w;const h=new Map(w);return h.set(n,x(N)),h})},[n]),qe=c.useCallback(async x=>{if(!(!E||!window.tauriAPI?.terminal))try{let w=x;if(!w&&E.activePaneId){const D=ge(E.layout,E.activePaneId);D&&D.type==="terminal"&&(w=await window.tauriAPI.terminal.getCwd(D.session.id)||D.session.cwd)}w=w||E.rootPath;const N=await window.tauriAPI.terminal.create(w),h=le(),L={type:"terminal",id:h,session:N};Ie(D=>{const I=D.activePaneId||D.layout&&ve(D.layout)[0]||null,R=D.layout?I?Ue(D.layout,I,"horizontal",L):{type:"split",id:le(),direction:"horizontal",children:[D.layout,L],sizes:[50,50]}:L;return{...D,layout:R,activePaneId:h}})}catch{}},[E,Ie]),We=c.useCallback(x=>{if(!E)return;const w=le(),N={type:"editor",id:w,rootPath:E.rootPath,filePath:x};Ie(h=>{const L=h.activePaneId||h.layout&&ve(h.layout)[0]||null,D=h.layout?L?Ue(h.layout,L,"horizontal",N):{type:"split",id:le(),direction:"horizontal",children:[h.layout,N],sizes:[50,50]}:N;return{...h,layout:D,activePaneId:w}})},[E,Ie]),An=c.useCallback(x=>{if(!E)return;const w=E.layout;if(w){const N=L=>{if(L.type==="editor")return L;if(L.type==="split")for(const D of L.children){const I=N(D);if(I)return I}return null},h=N(w);if(h){window.dispatchEvent(new CustomEvent("bridgespace:open-file",{detail:{filePath:x,editorPaneId:h.id}}));return}}We(x)},[E,We]),Ye=c.useCallback(async(x,w,N)=>{const h=e.get(x);if(!h?.layout||!window.tauriAPI?.terminal)return;const L=ge(h.layout,w);if(L&&!(L.type!=="terminal"&&L.type!=="editor"))try{let D=h.rootPath;L.type==="terminal"?D=await window.tauriAPI.terminal.getCwd(L.session.id)||L.session.cwd:L.type==="editor"&&(D=L.rootPath||h.rootPath);const I=await window.tauriAPI.terminal.create(D),R=le(),$={type:"terminal",id:R,session:I};t(H=>{const J=H.get(x);if(!J||!J.layout)return H;const he=new Map(H);return he.set(x,{...J,layout:Ue(J.layout,w,N,$),activePaneId:R}),he})}catch{}},[e]),xt=c.useCallback(async(x,w)=>{n&&await Ye(n,x,w)},[n,Ye]),Je=c.useCallback((x,w)=>{const N=e.get(x);if(!N?.layout)return;const h=ge(N.layout,w);h&&h.type==="terminal"&&window.tauriAPI?.terminal?.destroy(h.session.id);const D=ve(N.layout).filter(I=>I!==w);t(I=>{const R=I.get(x);if(!R||!R.layout)return I;const $=Xe(R.layout,w),H=new Map(I);return H.set(x,{...R,layout:$,activePaneId:R.activePaneId===w?D[D.length-1]||null:R.activePaneId}),H}),D.length===0&&me(x)},[e,me]),gt=c.useCallback(x=>{n&&Je(n,x)},[n,Je]),Qe=c.useCallback((x,w)=>{t(N=>{const h=N.get(x);if(!h)return N;const L=new Map(N);return L.set(x,{...h,activePaneId:w}),L})},[]),bt=c.useCallback(x=>{n&&Qe(n,x)},[n,Qe]),Ze=c.useCallback(x=>{if(!E?.layout)return;const w=ve(E.layout);if(w.length<=1)return;const N=w.indexOf(E.activePaneId||"");let h;x==="next"?h=(N+1)%w.length:h=(N-1+w.length)%w.length,bt(w[h])},[E,bt]),et=c.useCallback(x=>{const w=Array.from(e.keys());if(w.length<=1)return;const N=w.indexOf(n||"");let h;x==="next"?h=(N+1)%w.length:h=(N-1+w.length)%w.length,Ee(w[h])},[e,n,Ee]),Rn=c.useCallback(x=>{Ee(x)},[Ee]),_n=c.useCallback(x=>{me(x)},[me]),On=c.useCallback((x,w)=>{t(N=>{const h=N.get(x);if(!h)return N;const L=new Map(N);return L.set(x,{...h,name:w}),L})},[]),Wn=c.useCallback((x,w)=>{t(N=>{const h=N.get(x);if(!h)return N;const L=new Map(N);return L.set(x,{...h,color:w}),L})},[]),Bn=c.useCallback((x,w,N)=>{t(h=>{const L=Array.from(h.entries()),D=L.findIndex(([H])=>H===x),I=L.findIndex(([H])=>H===w);if(D===-1||I===-1)return h;const[R]=L.splice(D,1);let $=L.findIndex(([H])=>H===w);return N==="after"&&($+=1),L.splice($,0,R),new Map(L)})},[]),Gn=c.useCallback(()=>{K()},[K]),$n=c.useCallback(()=>{l("settings")},[]),Fn=c.useCallback(()=>{r(null),l("terminal")},[]);c.useEffect(()=>{const x=w=>{const N=w;if(N.detail){const{projectId:h,path:L}=N.detail;L&&y(L),h&&L&&Yt(h,L)}};return window.addEventListener("bridgespace:project-changed",x),()=>window.removeEventListener("bridgespace:project-changed",x)},[]),c.useEffect(()=>{const x=h=>{const D=navigator.platform.toUpperCase().indexOf("MAC")>=0?h.metaKey:h.ctrlKey,I=h.code;(I==="ShiftLeft"||I==="ShiftRight")&&(s.current=!0);const R=h.shiftKey||(h.getModifierState?.("Shift")??!1)||s.current;if(D&&!R&&!h.altKey){const H={Digit1:"terminal",Digit2:"kanban",Digit3:"agents",Digit4:"prompts"}[I];if(H){h.preventDefault(),p(H);return}}if(D&&I==="Comma"&&!R){h.preventDefault(),l("settings");return}if(D&&I==="KeyP"&&!R){h.preventDefault(),E&&o==="terminal"&&T($=>!$);return}if(D&&I==="KeyB"&&!R){h.preventDefault(),window.dispatchEvent(new CustomEvent("bridgespace:toggle-sidebar"));return}if(D&&R&&I==="KeyE"){h.preventDefault(),E&&o==="terminal"&&We();return}if(D&&I==="KeyT"){h.preventDefault(),K();return}if(D&&I==="KeyN"&&!R){h.preventDefault(),E?qe():A();return}if(D&&I==="KeyD"){if(h.preventDefault(),E?.activePaneId&&o==="terminal"){const $=h.shiftKey?"vertical":"horizontal";xt(E.activePaneId,$)}return}if(D&&I==="KeyW"&&!R){if(!E?.activePaneId||o!=="terminal")return;h.preventDefault(),gt(E.activePaneId);return}if(D&&R&&I==="KeyW"){if(!n)return;h.preventDefault(),me(n);return}if(D&&!R&&(I==="BracketRight"||h.altKey&&I==="ArrowRight")){h.preventDefault(),Ze("next");return}if(D&&!R&&(I==="BracketLeft"||h.altKey&&I==="ArrowLeft")){h.preventDefault(),Ze("prev");return}if(D&&R&&(I==="BracketRight"||I==="ArrowRight")){h.preventDefault(),et("next");return}if(D&&R&&(I==="BracketLeft"||I==="ArrowLeft")){h.preventDefault(),et("prev");return}},w=h=>{(h.code==="ShiftLeft"||h.code==="ShiftRight")&&(s.current=!1)},N=()=>{s.current=!1};return window.addEventListener("keydown",x,!0),window.addEventListener("keyup",w,!0),window.addEventListener("blur",N),()=>{window.removeEventListener("keydown",x,!0),window.removeEventListener("keyup",w,!0),window.removeEventListener("blur",N)}},[o,E,n,A,K,qe,We,xt,gt,me,Ze,et,p,u]),c.useEffect(()=>{if(O.current)return;O.current=!0,(async()=>{try{const w=await window.tauriAPI?.system?.getInitialPath();w&&await B(w)}catch{}})()},[B]);const Hn=c.useCallback(async x=>{let w=null;if(x.projectId){const h=as(x.projectId);h&&await window.tauriAPI?.fs?.exists(h)&&(w=h)}if(!w&&x.projectId){const h=await window.tauriAPI?.dialog?.openFolder({title:"Select Folder for This Project"});if(h)w=h,Yt(x.projectId,h),y(h);else return}if(w||(w=g),!w){const h=await window.tauriAPI?.dialog?.openFolder({title:"Select Project Folder to Run Task"});if(h)w=h,y(h);else return}if(!w)return;const N=await B(w);if(N&&N.sessionId){const h=(N.shell||"").toLowerCase(),L=h.includes("powershell")||h.includes("pwsh"),D=h.includes("cmd.exe");let I="";x.taskKnowledge&&x.taskKnowledge.trim()?I=`<context>
${x.taskKnowledge}
</context>

<instructions>
${x.instructions}
</instructions>`:I=x.instructions;let R="";L?R=`claude '${I.replace(/'/g,"''")}'`:D?R=`claude "${I.replace(/\n/g," ").replace(/"/g,'""')}"`:R=`claude '${I.replace(/'/g,"'\\''")}'`;let $=!1,H=!1;const J=()=>{H||(H=!0,window.tauriAPI.terminal.write(N.sessionId,R+`
`))},he=window.tauriAPI.terminal.onData(ae=>{ae.id===N.sessionId&&!$&&ae.data.includes("\x1B]133;A")&&($=!0,setTimeout(()=>{J(),he()},100))});setTimeout(()=>{H||(J(),he())},1500)}},[g,B]),Kn=()=>a.jsxs(c.Suspense,{fallback:a.jsx("div",{className:"flex items-center justify-center h-full w-full",children:a.jsx("div",{className:"text-text-muted text-sm",children:"Loading..."})}),children:[o==="settings"&&a.jsx(rs,{}),o==="kanban"&&a.jsx(es,{onRunTask:Hn}),o==="agents"&&a.jsx(ts,{}),o==="prompts"&&a.jsx(ns,{})]}),Vn=o==="terminal"&&e.size===0;return a.jsx(Xa,{children:a.jsx(Qa,{children:a.jsxs("div",{className:"flex flex-col h-screen w-screen bg-background overflow-hidden transition-colors duration-300",children:[a.jsx(na,{activeView:o,onViewChange:p,tabs:W,activeTabId:n,onTabClick:Rn,onCloseTab:_n,onRenameTab:On,onColorChange:Wn,onNewTab:Gn,onReorderTabs:Bn,onSettings:$n,onLogoClick:Fn,isDraggingPane:S,onPaneDropToNewWorkspace:oe}),S&&a.jsx(os,{onDrop:oe,activeWorkspaceId:n}),a.jsxs("main",{className:"flex-1 min-h-0 bg-background overflow-hidden transition-colors duration-300 relative",children:[o!=="terminal"&&a.jsx("div",{className:"absolute inset-0 z-10 h-full w-full bg-background overflow-hidden",children:Kn()}),Vn&&a.jsx(c.Suspense,{fallback:null,children:a.jsx(Za,{onNewTerminal:x=>{x?B(x):A()}})}),Array.from(e.values()).map(x=>a.jsx(is,{workspace:x,isActive:x.id===n&&o==="terminal",onFocusPane:Qe,onClosePane:Je,onSplitPane:Ye,onCreatePane:qe,onDragStateChange:C,onPaneReorder:de,onPaneLayoutChange:ye},x.id))]}),a.jsx(Rr,{isOpen:f,onClose:()=>{m(!1),b(null)},onSelect:P,defaultDirectory:d?.cwd}),a.jsx(Wr,{isOpen:z,rootPath:E?.rootPath||null,onClose:()=>T(!1),onFileOpen:An}),a.jsx(Br,{isOpen:v,onClose:()=>{j(!1),b(null);const x=k.current;k.current=[];for(const w of x)w?.id&&window.tauriAPI?.terminal?.destroy(w.id)},onSelect:(x,w)=>{_(x,w),j(!1)},defaultColor:d?at(d.tabIndex):"blue",defaultName:d?Nt(d.tabIndex):"Workspace 1"}),a.jsx(Ka,{isOpen:i.isOpen,version:i.version,isDownloading:i.isDownloading,isDownloaded:i.isDownloaded,downloadPercent:i.downloadPercent,onInstall:i.handleInstall,onDismiss:i.handleDismiss})]})})})}const gs=Object.freeze(Object.defineProperty({__proto__:null,default:ds},Symbol.toStringTag,{value:"Module"}));export{Jn as B,tn as C,kt as D,nn as F,mr as L,gs as M,ct as P,sn as S,Yr as T,rr as a,yr as b,gr as c,hs as d,rn as e,jr as f,tr as g,xs as u};
