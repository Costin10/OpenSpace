import{r as n,j as a}from"./vendor-codemirror-YmvNK9KJ.js";import{_ as Ae}from"./vendor-markdown-Bqz58gXN.js";import{D as Pe,o as De,L as Fe}from"./vendor-xterm-B6483nPg.js";import{u as je,L as Se,T as re,d as Ne}from"./MainApp-CsQxt9Iy.js";import{I as ge,F as Ee,G as Ie,C as Me,R as Te}from"./rows-2-lhzUQW9r.js";import{c as We,a as te,X as Ge}from"./index-BjdFrzXK.js";import{a as _e,C as $e}from"./circle-x-BsZCwU-6.js";import"./vendor-react-bmmOCWbf.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Ye=We("file-down",ze),be=8;let Y=0;function Le(){return Y<be}function Oe(){return Y>=be?!1:(Y++,!0)}function ne(){Y>0&&Y--}const ae={void:{background:"#020205",foreground:"#eeeeff",cursor:"#818cf8",cursorAccent:"#020205",selectionBackground:"rgba(99, 102, 241, 0.22)",selectionForeground:"#eeeeff",black:"#0a0a14",red:"#f43f5e",green:"#34d399",yellow:"#fbbf24",blue:"#6366f1",magenta:"#e879f9",cyan:"#818cf8",white:"#eeeeff",brightBlack:"#4a4a70",brightRed:"#fb7185",brightGreen:"#6ee7b7",brightYellow:"#fcd34d",brightBlue:"#a5b4fc",brightMagenta:"#f0abfc",brightCyan:"#c7d2fe",brightWhite:"#ffffff"},ghost:{background:"#050508",foreground:"#f0f0f2",cursor:"#10d5a9",cursorAccent:"#050508",selectionBackground:"rgba(16, 213, 169, 0.18)",selectionForeground:"#f0f0f2",black:"#0f0f10",red:"#fb7185",green:"#86efac",yellow:"#fde68a",blue:"#60a5fa",magenta:"#c084fc",cyan:"#10d5a9",white:"#f0f0f2",brightBlack:"#3e3e50",brightRed:"#fda4af",brightGreen:"#bbf7d0",brightYellow:"#fef9c3",brightBlue:"#93c5fd",brightMagenta:"#d8b4fe",brightCyan:"#6ee7b7",brightWhite:"#ffffff"},plasma:{background:"#050010",foreground:"#f4e8ff",cursor:"#e040fb",cursorAccent:"#050010",selectionBackground:"rgba(224, 64, 251, 0.22)",selectionForeground:"#f4e8ff",black:"#0f0020",red:"#f43f5e",green:"#4ade80",yellow:"#fbbf24",blue:"#818cf8",magenta:"#e040fb",cyan:"#22d3ee",white:"#f4e8ff",brightBlack:"#6a3d90",brightRed:"#fb7185",brightGreen:"#86efac",brightYellow:"#fcd34d",brightBlue:"#a5b4fc",brightMagenta:"#f5d0fe",brightCyan:"#67e8f9",brightWhite:"#ffffff"},carbon:{background:"#0c0c0c",foreground:"#e8e8e8",cursor:"#f59e0b",cursorAccent:"#0c0c0c",selectionBackground:"rgba(245, 158, 11, 0.22)",selectionForeground:"#e8e8e8",black:"#181818",red:"#ef4444",green:"#a3e635",yellow:"#f59e0b",blue:"#60a5fa",magenta:"#f97316",cyan:"#22d3ee",white:"#e8e8e8",brightBlack:"#606060",brightRed:"#f87171",brightGreen:"#bef264",brightYellow:"#fcd34d",brightBlue:"#93c5fd",brightMagenta:"#fdba74",brightCyan:"#67e8f9",brightWhite:"#ffffff"},hex:{background:"#010801",foreground:"#ccffcc",cursor:"#00ff41",cursorAccent:"#010801",selectionBackground:"rgba(0, 255, 65, 0.2)",selectionForeground:"#ccffcc",black:"#030b03",red:"#ff4444",green:"#00ff41",yellow:"#ccff00",blue:"#00aaff",magenta:"#44ff88",cyan:"#00dd55",white:"#ccffcc",brightBlack:"#286628",brightRed:"#ff6666",brightGreen:"#44ff44",brightYellow:"#eeff44",brightBlue:"#44aaff",brightMagenta:"#66ffaa",brightCyan:"#44ffcc",brightWhite:"#eeffee"},"neon-tokyo":{background:"#07000e",foreground:"#ffe8ff",cursor:"#ff0080",cursorAccent:"#07000e",selectionBackground:"rgba(255, 0, 128, 0.22)",selectionForeground:"#ffe8ff",black:"#0a0014",red:"#ff0040",green:"#39ff14",yellow:"#ffff00",blue:"#00ffff",magenta:"#ff00ff",cyan:"#00e0ff",white:"#ffe8ff",brightBlack:"#6633aa",brightRed:"#ff3366",brightGreen:"#66ff14",brightYellow:"#ffff44",brightBlue:"#44ffff",brightMagenta:"#ff44ff",brightCyan:"#44eeff",brightWhite:"#ffffff"},obsidian:{background:"#04020c",foreground:"#e8e0ff",cursor:"#8b5cf6",cursorAccent:"#04020c",selectionBackground:"rgba(139, 92, 246, 0.22)",selectionForeground:"#e8e0ff",black:"#0d0a1a",red:"#f87171",green:"#86efac",yellow:"#fbbf24",blue:"#818cf8",magenta:"#8b5cf6",cyan:"#34d399",white:"#e8e0ff",brightBlack:"#4a3880",brightRed:"#fca5a5",brightGreen:"#bbf7d0",brightYellow:"#fcd34d",brightBlue:"#a5b4fc",brightMagenta:"#c4b5fd",brightCyan:"#6ee7b7",brightWhite:"#ffffff"},nebula:{background:"#020010",foreground:"#f0e8ff",cursor:"#c084fc",cursorAccent:"#020010",selectionBackground:"rgba(192, 132, 252, 0.22)",selectionForeground:"#f0e8ff",black:"#060020",red:"#f472b6",green:"#34d399",yellow:"#fbbf24",blue:"#818cf8",magenta:"#c084fc",cyan:"#67e8f9",white:"#f0e8ff",brightBlack:"#5a3080",brightRed:"#f9a8d4",brightGreen:"#6ee7b7",brightYellow:"#fcd34d",brightBlue:"#a5b4fc",brightMagenta:"#d8b4fe",brightCyan:"#a5f3fc",brightWhite:"#ffffff"},storm:{background:"#090e14",foreground:"#e8eef8",cursor:"#fde047",cursorAccent:"#090e14",selectionBackground:"rgba(253, 224, 71, 0.22)",selectionForeground:"#e8eef8",black:"#131b24",red:"#f87171",green:"#4ade80",yellow:"#fde047",blue:"#60a5fa",magenta:"#f472b6",cyan:"#22d3ee",white:"#e8eef8",brightBlack:"#445566",brightRed:"#fca5a5",brightGreen:"#86efac",brightYellow:"#fef08a",brightBlue:"#93c5fd",brightMagenta:"#f9a8d4",brightCyan:"#67e8f9",brightWhite:"#ffffff"},infrared:{background:"#080100",foreground:"#fff4ee",cursor:"#ff6b35",cursorAccent:"#080100",selectionBackground:"rgba(255, 107, 53, 0.22)",selectionForeground:"#fff4ee",black:"#1a0500",red:"#dc2626",green:"#a3e635",yellow:"#ff6b35",blue:"#fb923c",magenta:"#f97316",cyan:"#fbbf24",white:"#fff4ee",brightBlack:"#7a3a22",brightRed:"#ef4444",brightGreen:"#bef264",brightYellow:"#fcd34d",brightBlue:"#fdba74",brightMagenta:"#fed7aa",brightCyan:"#fde68a",brightWhite:"#ffffff"},nova:{background:"#030106",foreground:"#fff8f0",cursor:"#f97316",cursorAccent:"#030106",selectionBackground:"rgba(249, 115, 22, 0.22)",selectionForeground:"#fff8f0",black:"#0c0312",red:"#ef4444",green:"#4ade80",yellow:"#fbbf24",blue:"#818cf8",magenta:"#f97316",cyan:"#22d3ee",white:"#fff8f0",brightBlack:"#705040",brightRed:"#f87171",brightGreen:"#86efac",brightYellow:"#fcd34d",brightBlue:"#a5b4fc",brightMagenta:"#fdba74",brightCyan:"#67e8f9",brightWhite:"#ffffff"},stealth:{background:"#0a0c0c",foreground:"#c8d8d0",cursor:"#34d399",cursorAccent:"#0a0c0c",selectionBackground:"rgba(52, 211, 153, 0.18)",selectionForeground:"#c8d8d0",black:"#141818",red:"#dc2626",green:"#34d399",yellow:"#a3a046",blue:"#4d9e8e",magenta:"#64748b",cyan:"#84cc16",white:"#c8d8d0",brightBlack:"#384840",brightRed:"#ef4444",brightGreen:"#6ee7b7",brightYellow:"#c4c46a",brightBlue:"#7fbfb5",brightMagenta:"#94a3b8",brightCyan:"#a3d15c",brightWhite:"#d8e8e0"},hologram:{background:"#010608",foreground:"#e0f6ff",cursor:"#00d4ff",cursorAccent:"#010608",selectionBackground:"rgba(0, 212, 255, 0.22)",selectionForeground:"#e0f6ff",black:"#04101e",red:"#f87171",green:"#34d399",yellow:"#fbbf24",blue:"#00d4ff",magenta:"#a78bfa",cyan:"#38bdf8",white:"#e0f6ff",brightBlack:"#2a6888",brightRed:"#fca5a5",brightGreen:"#6ee7b7",brightYellow:"#fcd34d",brightBlue:"#7dd3fc",brightMagenta:"#c4b5fd",brightCyan:"#bae6fd",brightWhite:"#ffffff"},dracula:{background:"#1a1b2e",foreground:"#f8f8f2",cursor:"#bd93f9",cursorAccent:"#1a1b2e",selectionBackground:"rgba(189, 147, 249, 0.3)",selectionForeground:"#f8f8f2",black:"#21222c",red:"#ff5555",green:"#50fa7b",yellow:"#f1fa8c",blue:"#bd93f9",magenta:"#ff79c6",cyan:"#8be9fd",white:"#f8f8f2",brightBlack:"#6272a4",brightRed:"#ff6e6e",brightGreen:"#69ff94",brightYellow:"#ffffa5",brightBlue:"#d6acff",brightMagenta:"#ff92df",brightCyan:"#a4ffff",brightWhite:"#ffffff"},bridgemind:{background:"#020408",foreground:"#eef2ff",cursor:"#00e5ff",cursorAccent:"#020408",selectionBackground:"rgba(0, 229, 255, 0.22)",selectionForeground:"#ffffff",black:"#080c14",red:"#ff3370",green:"#10ffb0",yellow:"#ffcc00",blue:"#3b82f6",magenta:"#bf5af2",cyan:"#00e5ff",white:"#eef2ff",brightBlack:"#3a5070",brightRed:"#ff6699",brightGreen:"#60ffcf",brightYellow:"#ffe55a",brightBlue:"#60a5fa",brightMagenta:"#d895ff",brightCyan:"#4ff4ff",brightWhite:"#ffffff"},paper:{background:"#f8f8f8",foreground:"#09090b",cursor:"#09090b",cursorAccent:"#f8f8f8",selectionBackground:"rgba(9, 9, 11, 0.15)",selectionForeground:"#09090b",black:"#18181b",red:"#dc2626",green:"#16a34a",yellow:"#ca8a04",blue:"#2563eb",magenta:"#7c3aed",cyan:"#0891b2",white:"#f4f4f5",brightBlack:"#71717a",brightRed:"#ef4444",brightGreen:"#22c55e",brightYellow:"#eab308",brightBlue:"#3b82f6",brightMagenta:"#8b5cf6",brightCyan:"#06b6d4",brightWhite:"#fafafa"},chalk:{background:"#fdf6ea",foreground:"#1a1008",cursor:"#16a34a",cursorAccent:"#fdf6ea",selectionBackground:"rgba(22, 163, 74, 0.18)",selectionForeground:"#1a1008",black:"#1a1008",red:"#dc2626",green:"#16a34a",yellow:"#d97706",blue:"#2563eb",magenta:"#7c3aed",cyan:"#0891b2",white:"#f5eed8",brightBlack:"#8a7060",brightRed:"#ef4444",brightGreen:"#22c55e",brightYellow:"#f59e0b",brightBlue:"#3b82f6",brightMagenta:"#8b5cf6",brightCyan:"#06b6d4",brightWhite:"#fdf8f0"},solar:{background:"#fdf6e3",foreground:"#073642",cursor:"#268bd2",cursorAccent:"#fdf6e3",selectionBackground:"rgba(38, 139, 210, 0.18)",selectionForeground:"#073642",black:"#073642",red:"#dc322f",green:"#859900",yellow:"#b58900",blue:"#268bd2",magenta:"#d33682",cyan:"#2aa198",white:"#eee8d5",brightBlack:"#586e75",brightRed:"#cb4b16",brightGreen:"#93a100",brightYellow:"#c9a800",brightBlue:"#4aa5f0",brightMagenta:"#e6389c",brightCyan:"#35b9ab",brightWhite:"#fdf6e3"},arctic:{background:"#f4f8ff",foreground:"#0f1c3f",cursor:"#2563eb",cursorAccent:"#ffffff",selectionBackground:"rgba(37, 99, 235, 0.15)",selectionForeground:"#0f1c3f",black:"#0f1c3f",red:"#dc2626",green:"#059669",yellow:"#d97706",blue:"#2563eb",magenta:"#7c3aed",cyan:"#0891b2",white:"#eff4ff",brightBlack:"#6680b0",brightRed:"#ef4444",brightGreen:"#10b981",brightYellow:"#f59e0b",brightBlue:"#3b82f6",brightMagenta:"#8b5cf6",brightCyan:"#06b6d4",brightWhite:"#ffffff"},ivory:{background:"#f7f4ee",foreground:"#1e1208",cursor:"#b45309",cursorAccent:"#f7f4ee",selectionBackground:"rgba(180, 83, 9, 0.15)",selectionForeground:"#1e1208",black:"#1e1208",red:"#dc2626",green:"#16a34a",yellow:"#b45309",blue:"#2563eb",magenta:"#7c3aed",cyan:"#0891b2",white:"#f3efe8",brightBlack:"#9a8060",brightRed:"#ef4444",brightGreen:"#22c55e",brightYellow:"#d97706",brightBlue:"#3b82f6",brightMagenta:"#8b5cf6",brightCyan:"#06b6d4",brightWhite:"#faf8f4"}};function Xe({sessionId:t,isActive:e=!0,isVisible:c=!0}){const{theme:i}=je(),l=n.useRef(null),s=n.useRef(null),g=n.useRef(null),o=n.useRef(null),u=n.useRef(null),w=n.useRef(null),y=n.useRef(null),C=n.useRef(!0),P=n.useRef(!1),F=n.useRef([]),D=n.useRef(!1),R=n.useRef(null),[L,O]=n.useState(null);n.useEffect(()=>{window.tauriAPI?.terminal?.setVisible(t,c)},[t,c]),n.useEffect(()=>{C.current=!0;let j=null;const X=()=>{!C.current||!g.current||y.current===null&&(y.current=requestAnimationFrame(()=>{if(y.current=null,!(!C.current||!g.current||!s.current))try{g.current.fit();const{cols:b,rows:p}=s.current;b>0&&p>0&&window.tauriAPI?.terminal?.resize(t,b,p)}catch{}}))},q=()=>{const b=s.current;if(!b){D.current=!1;return}const p=F.current.join("");if(F.current=[],!p){D.current=!1;return}b.write(p,()=>{if(F.current.length===0){D.current=!1;return}R.current===null&&(R.current=requestAnimationFrame(()=>{R.current=null,q()}))})},S=b=>{b&&(F.current.push(b),s.current&&(D.current||(D.current=!0,R.current===null&&(R.current=requestAnimationFrame(()=>{R.current=null,q()})))))},W=()=>{const b=l.current;if(C.current){if(!b){j=requestAnimationFrame(W);return}if(!s.current){if(!window.tauriAPI?.terminal){O("Desktop bridge not available");return}try{const p=new Pe({cursorBlink:!0,cursorStyle:"block",fontSize:14,fontFamily:'"JetBrains Mono", "SF Mono", Menlo, Monaco, monospace',lineHeight:1.2,theme:ae[i],allowTransparency:!1,scrollback:1e4,scrollOnUserInput:!0,overviewRuler:{width:0},fastScrollSensitivity:5,minimumContrastRatio:1}),N=new De;p.loadAddon(N),g.current=N,p.loadAddon(new Fe),p.open(b),s.current=p,Le()&&Ae(async()=>{const{WebglAddon:k}=await import("./vendor-xterm-B6483nPg.js").then(B=>B.a);return{WebglAddon:k}},[]).then(({WebglAddon:k})=>{if(!(!C.current||p!==s.current)&&Oe()){P.current=!0;try{const B=new k;B.onContextLoss(()=>{ne(),P.current=!1;try{B.dispose()}catch{}}),p.loadAddon(B)}catch{ne(),P.current=!1}}}).catch(()=>{}),X(),p.onData(k=>{window.tauriAPI.terminal.write(t,k)});const H=window.tauriAPI.terminal.onDataForSession(t,k=>{S(k)});u.current=H;const z=window.tauriAPI.terminal.onExitForSession(t,k=>{S(`\r
\x1B[90m[Process exited with code ${k}]\x1B[0m\r
`),window.tauriAPI?.terminal?.destroy(t)});w.current=z;const E=new ResizeObserver(X);E.observe(b),o.current=E,e&&p.focus()}catch(p){const N=p instanceof Error?p.message:"Terminal init failed";O(N)}}}};return W(),()=>{C.current=!1,j!==null&&cancelAnimationFrame(j),y.current!==null&&(cancelAnimationFrame(y.current),y.current=null),R.current!==null&&(cancelAnimationFrame(R.current),R.current=null),D.current=!1,F.current=[],P.current&&(ne(),P.current=!1),u.current?.(),u.current=null,w.current?.(),w.current=null,o.current?.disconnect(),o.current=null,g.current=null,s.current?.dispose(),s.current=null}},[t]),n.useEffect(()=>{s.current&&(s.current.options.theme=ae[i])},[i]),n.useEffect(()=>{e&&s.current?.focus()},[e]);const K=ae[i].background??"#000";return a.jsxs("div",{className:"absolute inset-0",style:{background:K},onClick:()=>s.current?.focus(),children:[a.jsx("div",{ref:j=>{l.current=j},className:"bm-xterm-container absolute inset-0"}),L&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80 z-50 p-4",children:a.jsxs("div",{className:"text-red-400 font-mono text-sm text-center space-y-2",children:[a.jsx("p",{className:"font-semibold",children:"Terminal Error"}),a.jsx("p",{className:"text-xs opacity-80",children:L}),a.jsx("button",{onClick:()=>window.location.reload(),className:"mt-2 px-3 py-1 text-xs bg-red-500/20 hover:bg-red-500/30 rounded transition-colors",children:"Reload"})]})})]})}function qe({state:t,fileCount:e=0,hasImages:c=!1,destinationPath:i}){const l=t==="copying",s=o=>o?o.replace(/^\/Users\/[^/]+/,"~").replace(/^\/home\/[^/]+/,"~"):"",g=l?"Copying...":e===1?"Drop to copy file here":`Drop to copy ${e} files here`;return a.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm pointer-events-none",children:[a.jsx("div",{className:"absolute inset-3 border-2 border-dashed border-accent-blue/50 rounded-xl animate-pulse"}),a.jsxs("div",{className:"bg-surface border border-border text-text-primary px-5 py-3 rounded-lg shadow-xl flex items-center gap-3",children:[l?a.jsx(Se,{size:18,className:"text-accent-blue animate-spin"}):c?a.jsx(ge,{size:18,className:"text-accent-magenta"}):a.jsx(Ye,{size:18,className:"text-accent-blue"}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium text-sm",children:g}),i&&a.jsx("span",{className:"text-[11px] text-text-muted truncate max-w-[220px]",children:s(i)})]})]})]})}const he="application/x-file-path",ie="text/uri-list",He=new Set(["png","jpg","jpeg","gif","webp","svg","bmp","ico","tiff"]),de=t=>{const e=t.path;if(e)return e;const c=window.tauriAPI?.fs?.getPathForFile?.(t);return c||null},Ue=t=>{const e=t.split(".").pop()?.toLowerCase()??"";return He.has(e)},me=t=>t?t.split(`
`).map(e=>e.trim()).filter(e=>e&&!e.startsWith("#")).map(e=>{try{const c=new URL(e);if(c.protocol!=="file:")return null;let i=decodeURIComponent(c.pathname);return i.startsWith("/")&&/^[A-Za-z]:/.test(i.slice(1))&&(i=i.slice(1)),i}catch{return null}}).filter(e=>!!e):[],V=t=>{const e=Array.from(t.types||[]);if(e.includes("Files")||e.includes(he))return!0;if(t.items){for(const c of Array.from(t.items))if(c.kind==="file")return!0}return e.includes(ie)?me(t.getData(ie)).length>0:!1},Ze=t=>{const e=[],c=new Set,i=new Set,l=o=>{!o||c.has(o)||(c.add(o),e.push({path:o}))},s=o=>{if(!o)return;const u=`${o.name}:${o.size}:${o.lastModified}:${o.type}`;i.has(u)||(i.add(u),e.push({file:o}))},g=t.getData(he);if(g)for(const o of g.split(`
`).map(u=>u.trim()).filter(Boolean))l(o);if(t.files&&t.files.length>0)for(const o of Array.from(t.files)){const u=de(o);u?l(u):s(o)}if(e.length===0&&t.items)for(const o of Array.from(t.items)){if(o.kind!=="file")continue;const u=o.getAsFile(),w=u?de(u):null;w?l(w):s(u)}if(e.length===0)for(const o of me(t.getData(ie)))l(o);return e},Je=async(t,e)=>{const c=window.tauriAPI;if(!c?.fs)throw new Error("File system API not available");const i=await c.fs.join(t,e);if(!await c.fs.exists(i))return i;const s=e.lastIndexOf("."),g=s>0?e.slice(0,s):e,o=s>0?e.slice(s):"";for(let u=1;u<=99;u++){const w=`${g} (${u})${o}`,y=await c.fs.join(t,w);if(!await c.fs.exists(y))return y}throw new Error(`Too many copies of "${e}" in destination`)},Qe=async(t,e)=>{const c=window.tauriAPI;if(!c?.fs)throw new Error("File system API not available");const i=[];for(const l of t){const s=`drop-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,g=typeof l=="string"?l:l instanceof File?null:l.path||null,o=l instanceof File?l:typeof l=="object"&&l!==null&&"file"in l&&l.file||null;try{if(!g&&!o)throw new Error("Missing dropped file source");const u=g?await c.fs.basename(g):o?.name||"dropped-file",w=await Je(e,u),y=await c.fs.basename(w);if(g)await c.fs.copy(g,w);else if(o){const C=new Uint8Array(await o.arrayBuffer());if(!c.fs.copyDroppedFile)throw new Error("Dropped file byte-copy is not supported by this runtime");await c.fs.copyDroppedFile(w,C)}i.push({id:s,sourcePath:g||`[dropped] ${u}`,destPath:w,fileName:y,success:!0})}catch(u){const w=g?g.split("/").pop()||g:o?.name||"file",y=u instanceof Error?u.message:"Copy failed";i.push({id:s,sourcePath:g||`[dropped] ${w}`,destPath:"",fileName:w,success:!1,error:y})}}return i};function Ve({result:t,onDismiss:e}){n.useEffect(()=>{const i=setTimeout(e,3e3);return()=>clearTimeout(i)},[e]);const c=Ue(t.fileName);return a.jsxs("div",{className:`
        flex items-center gap-2.5 px-3 py-2 rounded-lg shadow-lg border
        text-sm animate-in slide-in-from-right-5 fade-in duration-200
        ${t.success?"bg-surface border-accent-green/30":"bg-surface border-accent-red/30"}
      `,children:[t.success?a.jsx(_e,{size:15,className:"text-accent-green flex-shrink-0"}):a.jsx($e,{size:15,className:"text-accent-red flex-shrink-0"}),c?a.jsx(ge,{size:14,className:"text-accent-magenta flex-shrink-0"}):a.jsx(Ee,{size:14,className:"text-text-muted flex-shrink-0"}),a.jsxs("div",{className:"flex flex-col min-w-0",children:[a.jsx("span",{className:"text-text-primary text-xs font-medium truncate max-w-[180px]",children:t.fileName}),t.success?a.jsx("span",{className:"text-[10px] text-text-muted",children:"Copied to terminal CWD"}):a.jsx("span",{className:"text-[10px] text-accent-red truncate max-w-[180px]",children:t.error||"Copy failed"})]})]})}function Ke({results:t,onDismiss:e}){const c=n.useCallback(i=>()=>e(i),[e]);return t.length===0?null:a.jsx("div",{className:"absolute bottom-3 right-3 z-[60] flex flex-col gap-1.5 pointer-events-auto",children:t.map(i=>a.jsx(Ve,{result:i,onDismiss:c(i.id)},i.id))})}function er(t){return t.replace(/^\/Users\/[^/]+/,"~").replace(/^\/home\/[^/]+/,"~")}function rr(t,e){const c=(e||"").toLowerCase(),i=window.tauriAPI?.system?.platform;return c.includes("powershell")||c.includes("pwsh")?`'${t.replace(/'/g,"''")}'`:c.includes("cmd.exe")||i==="win32"?`"${t.replace(/"/g,'""')}"`:`'${t.replace(/'/g,"'\\''")}'`}function ce(t,e,c){return t>=c.left&&t<=c.right&&e>=c.top&&e<=c.bottom}function fe(t){const e=t.files?.length??0;if(e>0)return e;const c=Array.from(t.items??[]).filter(i=>i.kind==="file").length;return c>0?c:1}function tr(t,e){return/^[A-Za-z0-9._-]+$/.test(t)?t:rr(t,e)}const nr=40,ar=120,gr=n.memo(function({session:e,paneId:c,workspaceId:i,isActive:l,isVisible:s=!0,onClose:g,onFocus:o,onSplit:u,onPaneDragStart:w,onPaneDragEnd:y,isDragTarget:C,dragPosition:P}){const[F,D]=n.useState(!1),[R,L]=n.useState("drag-over"),[O,K]=n.useState(0),[j,X]=n.useState(null),[q,S]=n.useState([]),W=n.useRef(null),b=n.useRef(!1),p=n.useRef(!1),N=n.useRef("drag-over"),H=n.useRef(0),z=n.useRef(null),E=n.useRef(null),k=n.useRef(0),B=n.useRef(null),G=n.useRef(null),[oe,se]=n.useState(null),[pe,le]=n.useState(e.cwd);n.useEffect(()=>{let r=!0,f=null;const h=async(m=0)=>{try{const x=await window.tauriAPI?.terminal?.getCwd(e.id)||e.cwd||"";if(!x){m<5&&r&&(f=setTimeout(()=>{r&&h(m+1)},300*(m+1)));return}const A=await window.tauriAPI?.system?.getInfo(x);r&&A&&(se(A.gitBranch??null),le(A.cwd||x))}catch{m<5&&r&&(f=setTimeout(()=>{r&&h(m+1)},300*(m+1)))}};return h(),()=>{r=!1,f!==null&&clearTimeout(f)}},[e.id,e.cwd]),n.useEffect(()=>{if(!s||!l)return;let r=!0;const h=setInterval(async()=>{try{const d=await window.tauriAPI?.terminal?.getCwd(e.id)||e.cwd;if(!d)return;const x=await window.tauriAPI?.system?.getInfo(d);r&&x&&(se(x.gitBranch??null),le(x.cwd||d))}catch{}},3e4);return()=>{r=!1,clearInterval(h)}},[e.id,e.cwd,s,l]);const ee=n.useRef(e);ee.current=e;const I=n.useCallback(r=>{p.current!==r&&(p.current=r,D(r))},[]),_=n.useCallback(r=>{N.current!==r&&(N.current=r,L(r))},[]),M=n.useCallback(r=>{H.current!==r&&(H.current=r,K(r))},[]),U=n.useCallback(r=>{z.current!==r&&(z.current=r,X(r))},[]),Z=n.useCallback(async r=>{if(B.current)return B.current;if(G.current)return G.current;const f=window.tauriAPI?.terminal?.getCwd;if(!f)return null;const h=f(r).then(m=>{const d=m||null;return d&&(B.current=d,U(d)),d}).catch(()=>null).finally(()=>{G.current=null});return G.current=h,h},[U]),$=n.useCallback((r=!1)=>{const f=W.current;if(!f)return null;const h=performance.now(),m=E.current;if(!r&&m&&h-m.measuredAt<ar)return m.rect;const d=f.getBoundingClientRect();return E.current={rect:d,measuredAt:h},d},[]);n.useEffect(()=>{B.current=null,G.current=null,E.current=null,U(null)},[e.id,U]);const v=n.useCallback(()=>{b.current=!1,E.current=null,k.current=0,B.current=null,G.current=null,I(!1),_("drag-over"),M(0)},[M,_,I]),ue=n.useCallback(async r=>{const f=Ze(r),h=f.map(d=>d.path||null).filter(d=>!!d);if(f.length===0){const d=fe(r);S(x=>[...x,{id:`drop-path-missing-${Date.now()}`,sourcePath:"",destPath:"",fileName:d===1?"file":`${d} files`,success:!1,error:"Could not resolve dropped file path(s)."}]),v();return}_("copying"),I(!0),M(f.length);const m=ee.current;try{const x=await Z(m.id)||z.current||m.cwd,A=await Qe(f,x);S(T=>[...T,...A]);const Q=A.filter(T=>T.success).map(T=>tr(T.fileName,m.shell));if(Q.length>0&&window.tauriAPI?.terminal){const T=`${Q.join(" ")} `;window.tauriAPI.terminal.write(m.id,T)}}catch(d){const x=d instanceof Error?d.message:"Copy failed";S(A=>[...A,{id:`drop-err-${Date.now()}`,sourcePath:h[0]||"",destPath:"",fileName:f.length===1?h[0]?.split("/").pop()||f[0].file?.name||"file":`${f.length} files`,success:!1,error:x}])}finally{v()}},[v,Z,M,_,I]),J=n.useCallback((r,f,h,m)=>{if(!V(r)||r.types.includes("application/x-bridgespace-pane"))return;const d=performance.now();if(m==="dragover"&&b.current&&d-k.current<nr){I(!0),M(fe(r));return}k.current=d;const x=$();if(!x)return;if(!ce(f,h,x)){b.current&&v();return}if(!b.current){b.current=!0,_("drag-over");const Q=ee.current.id;Z(Q)}I(!0),M(fe(r))},[v,$,Z,M,_,I]),we=n.useCallback(r=>{const f=r.dataTransfer;f&&(J(f,r.clientX,r.clientY,"dragenter"),V(f)&&!f.types.includes("application/x-bridgespace-pane")&&(r.preventDefault(),f.dropEffect="copy"))},[J]),ye=n.useCallback(r=>{const f=r.dataTransfer;f&&(J(f,r.clientX,r.clientY,"dragover"),V(f)&&!f.types.includes("application/x-bridgespace-pane")&&(r.preventDefault(),f.dropEffect="copy"))},[J]),xe=n.useCallback(r=>{if(!b.current||r.relatedTarget&&W.current?.contains(r.relatedTarget))return;const f=$(!0);(!f||!ce(r.clientX,r.clientY,f))&&v()},[v,$]),ke=n.useCallback(r=>{const f=r.dataTransfer;if(!f||!V(f)||f.types.includes("application/x-bridgespace-pane"))return;const h=$(!0);if(!h)return;if(!ce(r.clientX,r.clientY,h)){b.current&&v();return}r.preventDefault(),r.stopPropagation(),ue(f)},[v,$,ue]),Ce=n.useCallback(()=>{b.current&&v()},[v]),Re=n.useCallback(r=>{S(f=>f.filter(h=>h.id!==r))},[]),Be=n.useCallback(r=>{const f=JSON.stringify({paneId:c,workspaceId:i,session:e});r.dataTransfer.setData("application/x-bridgespace-pane",f),r.dataTransfer.effectAllowed="move",w?.(c)},[c,i,e,w]),ve=n.useCallback(()=>{y?.()},[y]);return a.jsxs("div",{className:te("simple-terminal-pane terminal-panel group/pane",l&&"active"),onClick:o,children:[a.jsxs("div",{draggable:!0,onDragStart:Be,onDragEnd:ve,className:te("terminal-panel-header terminal-panel-header-drag",l&&"active"),children:[a.jsxs("div",{className:"terminal-panel-meta",children:[a.jsx("span",{className:te("terminal-panel-status-dot",l&&"active")}),a.jsx("span",{className:"terminal-path truncate",children:er(pe)}),oe&&a.jsxs("span",{className:"terminal-git",children:[a.jsx(Ie,{size:9}),oe]})]}),a.jsxs("div",{className:"terminal-panel-actions group-hover/pane:opacity-100",children:[a.jsx(re,{content:"Split Right  ⌘D",side:"bottom",delayMs:400,children:a.jsx("button",{onClick:r=>{r.stopPropagation(),u("horizontal")},className:"terminal-pane-action terminal-pane-action-split",children:a.jsx(Me,{size:10})})}),a.jsx(re,{content:"Split Down  ⌘⇧D",side:"bottom",delayMs:400,children:a.jsx("button",{onClick:r=>{r.stopPropagation(),u("vertical")},className:"terminal-pane-action terminal-pane-action-split",children:a.jsx(Te,{size:10})})}),a.jsx(re,{content:"Close  ⌘W",side:"bottom",delayMs:400,children:a.jsx("button",{onClick:r=>{r.stopPropagation(),g()},className:"terminal-pane-action terminal-pane-action-close",children:a.jsx(Ge,{size:10})})})]})]}),a.jsxs("div",{ref:W,className:"terminal-panel-body flex-1 min-h-0 relative",onDragEnterCapture:we,onDragOverCapture:ye,onDragLeaveCapture:xe,onDropCapture:ke,onDragEndCapture:Ce,children:[a.jsx(Xe,{sessionId:e.id,isActive:l,isVisible:s}),F&&a.jsx(qe,{state:R,fileCount:O,hasImages:!1,destinationPath:j||e.cwd}),C&&P&&a.jsx(Ne,{position:P}),a.jsx(Ke,{results:q,onDismiss:Re})]})]})});export{gr as SimpleTerminalPane};
